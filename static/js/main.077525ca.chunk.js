(this["webpackJsonpmy-editor"]=this["webpackJsonpmy-editor"]||[]).push([[0],{223:function(e,t,n){},366:function(e,t,n){},367:function(e,t,n){"use strict";n.r(t);var r,a=n(0),i=n(37),o=n.n(i),c=n(30),l=n(13),s=n(3),d=n(1),u=n(7),f=n(120);!function(e){e.EDITOR="editor",e.NUMBER_LIST="ol",e.NORMAL_LIST="ul",e.LIST_ITEM="li",e.DIV="div",e.Block="block",e.P="p",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.IMG="img",e.LINK="link",e.TABLE="table",e.TBODY="tbody",e.TR="tr",e.TD="td",e.TODOLIST="todo",e.CODE="code",e.FILE="file"}(r||(r={}));var h,b=[r.DIV,r.H1,r.H2,r.H3,r.H4,r.P],j=[r.IMG,r.LINK];!function(e){e.BOLD="bold",e.ITALIC="italic",e.FontSize="fontSize",e.Underline="underline",e.LineThrough="line-through",e.Color="color",e.BGColor="backgroundColor",e.TextAlign="textAlign"}(h||(h={}));var v=n(10),O=n(17),p=n(28),m=n.n(p),g=n(29),y={toggleList:function(e,t){var n=d.a.nodes(e,{mode:"lowest",match:function(t){return d.g.isText(t)||d.a.isInline(e,t)}}),a=Object(s.a)(n,1)[0];if(a){var i=d.a.parent(e,a[1]);if(i){var o=d.a.parent(e,i[1]),c=y.isListItem(o[0])&&o,l=c&&x.getParent(e,c[1]),u=c&&l&&d.b.isElement(l[0])&&(null===l||void 0===l?void 0:l[0].type)==t,f=c&&!u,h=!c;c&&u?d.h.unwrapNodes(e,{match:function(e){return y.isListItem(e)}}):f?d.a.withoutNormalizing(e,(function(){var n,r=new Set,a=d.a.nodes(e,{mode:"lowest",match:function(e){return y.isListItem(e)}}),i=Object(v.a)(a);try{for(i.s();!(n=i.n()).done;){var o=Object(s.a)(n.value,2)[1],c=x.getParent(e,o);null!=c[0]&&r.add(c[1].join("-"))}}catch(l){i.e(l)}finally{i.f()}r.forEach((function(n){var r=n.split("-").map((function(e){return+e}));d.h.setNodes(e,{type:t},{at:r,hanging:!0})}))})):h&&d.a.withoutNormalizing(e,(function(){for(var n=0,a=Array.from(d.a.nodes(e,{reverse:!0,mode:"lowest",match:function(e){return x.isTextWrapper(e)}}));n<a.length;n++){var i=Object(s.a)(a[n],2)[1];if(0!=i.length){var o=x.getParent(e,i),c=Object(s.a)(o,1)[0];y.isListItem(c)||(d.h.wrapNodes(e,{type:r.LIST_ITEM,children:[]},{at:i}),y.isOrderList(c)||d.h.wrapNodes(e,{type:t,children:[]},{at:i}))}}}))}}},isInLi:function(e){return!(!e.selection||!d.f.isCollapsed(e.selection))&&x.getFirstAboveElementType(e)==r.LIST_ITEM},isListItem:function(e){return d.b.isElement(e)&&[r.LIST_ITEM].includes(e.type)},isOrderList:function(e){return d.b.isElement(e)&&[r.NUMBER_LIST,r.NORMAL_LIST].includes(e.type)},normalizeList:function(e,t){var n=Object(s.a)(t,2),a=n[0],i=n[1];if(y.isListItem(a)){var o=x.getParent(e,i);if(0==o.length||!y.isOrderList(o[0]))return d.h.unwrapNodes(e,{at:i}),!0;if(0==a.children.length||1==a.children.length&&d.g.isText(d.c.child(a,0)))return d.h.removeNodes(e,{at:i}),!0;if(a.children.length>1){var c=i.concat([1]);return d.h.wrapNodes(e,{type:r.LIST_ITEM,children:[]},{at:c}),d.h.liftNodes(e,{at:c}),!0}var l,u=new Set,f=Object(v.a)(d.c.texts(a));try{for(f.s();!(l=f.n()).done;){var b=Object(s.a)(l.value,1)[0];u.add(b[h.Color])}}catch(R){f.e(R)}finally{f.f()}if(1==u.size){var j=Array.from(u).pop();return void(j&&d.h.setNodes(e,{liColor:j},{at:i}))}}if(y.isOrderList(a)){var O=x.getPath(i,"pre"),p=x.getNodeByPath(e,O),m=Object(s.a)(p,1)[0];if(y.isOrderList(m)&&m.type!=a.type)return d.h.setNodes(e,{type:a.type},{at:O}),!0;if(y.isOrderList(m)&&m.type==a.type)return d.h.mergeNodes(e,{at:i}),!0;var g=x.getPath(i,"next"),T=x.getNodeByPath(e,g),w=Object(s.a)(T,1)[0];if(y.isOrderList(w)&&w.type!=a.type)return d.h.setNodes(e,{type:w.type},{at:g}),!0;if(y.isOrderList(w)&&w.type==a.type)return d.h.mergeNodes(e,{at:g}),!0;if(1==a.children.length){var S=d.c.first(a,[0]),E=Object(s.a)(S,1)[0];if(y.isOrderList(E)&&E.type!=a.type)return d.h.setNodes(e,{type:E.type},{at:i}),!0}var N,D=Object(v.a)(d.c.children(e,i,{reverse:!0}));try{for(D.s();!(N=D.n()).done;){var C=Object(s.a)(N.value,2),L=C[0],I=C[1];if(!y.isListItem(L)&&!y.isOrderList(L))return d.h.liftNodes(e,{at:I}),!0}}catch(R){D.e(R)}finally{D.f()}var M,k=0,A=Object(v.a)(d.c.children(e,i,{reverse:!0}));try{for(A.s();!(M=A.n()).done;){var P=Object(s.a)(M.value,1)[0];(y.isOrderList(P)||y.isListItem(P))&&k++}}catch(R){A.e(R)}finally{A.f()}if(0==k)return d.h.removeNodes(e,{at:i}),!0}return!1},tabEvent:function(e){d.a.withoutNormalizing(e,(function(){var t,n=d.a.nodes(e,{universal:!0,mode:"lowest",match:function(e){return y.isListItem(e)}}),r=Object(v.a)(n);try{for(r.s();!(t=r.n()).done;){var a=Object(s.a)(t.value,2),i=a[0],o=a[1];y.indentLi(e,[i,o])}}catch(c){r.e(c)}finally{r.f()}}))},indentLi:function(e,t){d.a.withoutNormalizing(e,(function(){var n=Object(s.a)(t,1)[0],r=u.b.findPath(e,n),a=x.getNodeByPath(e,x.getPath(r,"next")),i=x.getParent(e,r);a.length>0&&y.isOrderList(null===a||void 0===a?void 0:a[0])?d.h.wrapNodes(e,{type:a[0].type,children:[]},{at:r}):i.length>0&&y.isOrderList(null===i||void 0===i?void 0:i[0])&&d.h.wrapNodes(e,{type:i[0].type,children:[]},{at:r})}))},shiftTabEvent:function(e){d.a.withoutNormalizing(e,(function(){var t,n=d.a.nodes(e,{universal:!0,reverse:!0,mode:"lowest",match:function(e){return y.isListItem(e)}}),r=Object(v.a)(n);try{for(r.s();!(t=r.n()).done;){var a=Object(s.a)(t.value,2),i=a[0],o=a[1];y.liftLi(e,[i,o])}}catch(c){r.e(c)}finally{r.f()}}))},liftLi:function(e,t){var n=Object(s.a)(t,2)[1],r=x.getParent(e,n),a=Object(s.a)(r,2),i=a[0],o=a[1],c=i&&x.getParent(e,o),l=Object(s.a)(c,1)[0];y.isOrderList(l)&&d.h.liftNodes(e,{at:n})}},x={encodeSlateContent:function(e){var t;return null===(t=window)||void 0===t?void 0:t.btoa(encodeURIComponent(JSON.stringify(e)))},decodeContentToSlateData:function(e){return JSON.parse(decodeURIComponent(window.atob(e)))},removeRangeElement:function(e){var t=e.selection;if(t&&!d.f.isCollapsed(t)){var n,a=d.a.nodes(e,{at:t,match:function(e){return d.b.isElement(e)&&e.type===r.CODE}}),i=Object(v.a)(a);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o){var c=d.a.range(e,o[1]),l=d.f.intersection(t,c);if(l&&d.f.equals(c,l))return d.h.removeNodes(e,{at:o[1]}),void x.removeRangeElement(e)}}}catch(B){i.e(B)}finally{i.f()}var u,f=d.a.nodes(e,{at:t,match:function(e){return H.isTable(e)}}),h=Object(v.a)(f);try{for(h.s();!(u=h.n()).done;){var b=u.value;if(b){var j=d.a.range(e,b[1]),O=d.f.intersection(t,j);if(O&&d.f.equals(j,O))return d.h.removeNodes(e,{at:b[1]}),void x.removeRangeElement(e)}}}catch(B){h.e(B)}finally{h.f()}var p,m=d.a.nodes(e,{at:t,match:function(e){return y.isOrderList(e)}}),g=Object(v.a)(m);try{for(g.s();!(p=g.n()).done;){var T=p.value;if(T){var w=d.a.range(e,T[1]),S=d.f.intersection(t,w);if(S&&d.f.equals(w,S))return d.h.removeNodes(e,{at:T[1]}),void x.removeRangeElement(e)}}}catch(B){g.e(B)}finally{g.f()}for(var E=Array.from(d.a.nodes(e,{reverse:!0,match:function(t,n){return d.g.isText(t)||d.a.isInline(e,t)}})),N=0,D=E;N<D.length;N++){var C=Object(s.a)(D[N],2)[1],L=x.getParent(e,C);if(d.b.isElement(L[0])&&L[0].type===r.TODOLIST){var I=L,M=d.a.range(e,I[1]),k=e.selection&&d.f.intersection(e.selection,M);if(!k)continue;d.f.equals(k,M)?d.h.removeNodes(e,{at:I[1]}):d.h.delete(e,{at:k,reverse:!0,unit:"character",hanging:!0})}else if(L.length>0&&x.isTextWrapper(L[0])){var A=d.a.range(e,L[1]),P=e.selection&&d.f.intersection(e.selection,A);if(!P)continue;var R=x.getParent(e,L[1]),z=Object(s.a)(R,1)[0],F=H.isTd(z);if(!d.f.equals(P,A)||F&&1==z.children.length||d.e.equals(E[0][1],C)){if(d.f.isCollapsed(P))continue;d.h.delete(e,{at:P,reverse:!0,unit:"character",hanging:!0})}else d.h.removeNodes(e,{at:L[1]})}}d.h.collapse(e,{edge:"start"})}},isTextWrapper:function(e){return d.b.isElement(e)&&b.includes(e.type)},getFirstAboveElementType:function(e){if(e.selection){var t=x.getParent(e,e.selection.anchor.path);if(!t[0])return null;var n=x.getParent(e,t[1]);return n[0]?d.b.isElement(n[0])&&n[0].type||d.a.isEditor(n[0])&&r.EDITOR:null}},getPath:function(e,t){var n=e.slice(0,e.length-1),r=e[e.length-1];return"parent"==t?n:[].concat(Object(O.a)(n),["pre"==t?r-1:r+1])},getNodeByPath:function(e,t){try{return d.a.node(e,t)}catch(n){return[]}},getParent:function(e,t){return this.getNodeByPath(e,this.getPath(t,"parent"))},isSelectTd:function(e){return null==H.getFirstSelectedTd(e)}},T={selectedTds:new Set,editingTdsPath:new Set,preSelectedTdPos:{row:0,col:0},copyedCellsPath:null,copyedAreaHeight:0,copyedAreaWidth:0,copyedCells:null,copyedContent:null},w=function(e){T.copyedContent=e},S=function(e){T.copyedCells=e},E=function(){return T.copyedCells},N=function(e){T.copyedAreaHeight=e.copyedAreaHeight,T.copyedAreaWidth=e.copyedAreaWidth},D=function(e){T.preSelectedTdPos=e},C=function(e){return I(e,T.selectedTds),T.selectedTds},L=function(e){T.selectedTds=e},I=function e(t,n){var r,a=Object(v.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value,o=i.split(",").map((function(e){return+e}));if(!d.a.hasPath(t,o))return n.delete(i),void e(t,n)}}catch(c){a.e(c)}finally{a.f()}},M=function(e){return I(e,T.editingTdsPath),T.editingTdsPath},k=function(e){T.editingTdsPath=e},A=n(2),P=100,R=30,z=function(e){var t=e.attributes,n=e.element,i=e.children,o=Object(u.g)(),c=Object(u.d)();Object(a.useEffect)((function(){var e=u.b.findPath(o,n);return null!=n.width&&null!=n.height||d.h.setNodes(o,{width:n.width||P,height:n.height||R},{at:e}),function(){var e=u.b.findPath(o,n).join(","),t=C(o),r=M(o);t.delete(e),r.delete(e)}}),[]),Object(a.useEffect)((function(){var e=u.b.findPath(o,n).join(","),t=C(o),r=M(o),a=n.canTdEdit,i=n.selected;!0===a?r.add(e):r.delete(e),!0===i?t.add(e):t.delete(e)}));var f={contentEditable:!1};!0===n.canTdEdit&&delete f.contentEditable;var b=Object(A.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,opacity:.6,color:"white",display:"flex",justifyContent:"center",alignItems:"center",fontSize:12,backgroundColor:"rgba(180,215,255,.7)",zIndex:9}});return Object(A.jsxs)("td",Object(l.a)(Object(l.a)(Object(l.a)({},t),{},{colSpan:n.colSpan,rowSpan:n.rowSpan,style:{minWidth:n.width||P,maxWidth:n.width||P,width:n.width||P,height:n.height||R,cursor:n.canTdEdit||c?"inherit":"cell",color:n[h.Color]||"unset",backgroundColor:n[h.BGColor]||"unset",userSelect:n.canTdEdit||c?"unset":"none",textAlign:n[h.TextAlign]||"unset",fontSize:n[h.FontSize]||"unset",fontWeight:n[h.BOLD]?"bold":"unset",fontStyle:n[h.ITALIC]?"italic":"unset",textDecoration:"".concat(n[h.Underline]?"underline":""," ").concat(n[h.LineThrough]?"line-through":"")}},f),{},{onDoubleClick:function(e){e.stopPropagation();var n=t.ref.current;if(n){var r=u.b.toSlateNode(o,n),a=u.b.findPath(o,r);F.editTd(o,[r,a])}},onMouseDown:function(e){if(!["resizer","columnSelector"].includes(e.target.className)&&!c){var n=t.ref.current;if(n){var r=u.b.toSlateNode(o,n),a=u.b.findPath(o,r);if(!d.b.isElement(r)||!r.canTdEdit){var i,l=e.target,s=u.b.toSlateNode(o,l),f=u.b.findPath(o,s);if(d.e.equals(f,a))i=[s,f];else{var h=d.a.above(o,{at:f,mode:"lowest",match:function(e){return H.isTd(e)}});if(!h)return;i=h}i&&F.chooseTd(o,i)}}}},children:[i,n.selected&&!c?b:null,c?null:Object(A.jsxs)(A.Fragment,{children:[Object(A.jsx)("span",{className:"resizer",style:{position:"absolute",zIndex:10,width:5,right:0,top:0,height:"100%",cursor:"col-resize",userSelect:"none"},contentEditable:!1,onMouseDown:function(e){for(var t=e.clientX,n=null,a=null,i=0,c=e.nativeEvent.path;i<c.length;i++){var l=c[i];if("TD"==l.tagName&&(n=l),"TABLE"==l.tagName){a=l;break}}if(null!=n&&null!=a){var f=u.b.toSlateNode(o,n),h=u.b.findPath(o,f),b=d.a.above(o,{at:h,match:function(e){return d.b.isElement(e)&&e.type==r.TBODY}});if(b){for(var j=F.getTdMap(b).tdMap,v=h.slice(h.length-2),p=Object(s.a)(v,2),m=p[0],g=p[1],y=-1,x=0;x<j.length;x++){for(var T=0;T<j[x].length;T++){var w=j[x][T];if(w.originCol==g&&w.originRow==m){y=w.col+w.colSpan-1;break}}if(-1!=y)break}if(-1!=y){for(var S=[],E=0;E<j.length;E++){var N=j[E][y],D=d.a.node(o,[].concat(Object(O.a)(b[1]),[N.originRow,N.originCol])),C=u.b.toDOMNode(o,D[0]);C.initX=C.offsetWidth,S.push(C)}var L=function(e){var n=e.clientX-t;S.forEach((function(e){e.style.maxWidth=e.style.width=e.style.minWidth=(e.initX+n<P?P:e.initX+n)+"px"}))};document.addEventListener("mousemove",L),document.addEventListener("mouseup",(function e(){Array.from(a.querySelectorAll(":scope>tbody>tr")).forEach((function(e,t){Array.from(e.querySelectorAll(":scope>td")).forEach((function(e,n){var r=parseInt(e.style.minWidth),a=u.b.toSlateNode(o,e);d.b.isElement(a)&&a.width!=r&&d.h.setNodes(o,{width:r},{at:[].concat(Object(O.a)(b[1]),[t,n])})}))})),document.removeEventListener("mousemove",L),document.removeEventListener("mouseup",e)}))}}}}}),Object(A.jsx)("span",{className:"resizer",style:{position:"absolute",zIndex:10,width:"100%",height:5,left:0,bottom:0,cursor:"row-resize",userSelect:"none"},contentEditable:!1,onMouseDown:function(e){for(var t=e.clientY,n=null,a=null,i=null,c=0,l=e.nativeEvent.path;c<l.length;c++){var f=l[c];if("TD"==f.tagName&&(n=f),"TR"==f.tagName&&(a=f),"TABLE"==f.tagName){i=f;break}}if(null!=n&&null!=a&&null!=i){var h=u.b.toSlateNode(o,n),b=u.b.findPath(o,h),j=d.a.above(o,{at:b,match:function(e){return d.b.isElement(e)&&e.type==r.TBODY}});if(j){for(var v=F.getTdMap(j).tdMap,p=b.slice(b.length-2),m=Object(s.a)(p,2),g=m[0],y=m[1],x=-1,T=0;T<v.length;T++){for(var w=0;w<v[T].length;w++){var S=v[T][w];if(S.originCol==y&&S.originRow==g){x=S.row+S.rowSpan-1;break}}if(-1!=x)break}if(-1!=x){for(var E=[],N=0;N<v[0].length;N++){var D=v[x][N],C=d.a.node(o,[].concat(Object(O.a)(j[1]),[D.originRow,D.originCol])),L=u.b.toDOMNode(o,C[0]);L.initY=L.offsetHeight,E.push(L)}var I=function(e){e.preventDefault();var n=e.clientY-t;E.forEach((function(e){return e.style.minHeight=e.style.height=e.style.maxHeight=(e.initY+n<=R?R:e.initY+n)+"px"}))};document.addEventListener("mousemove",I),document.addEventListener("mouseup",(function e(){Array.from(i.querySelectorAll(":scope>tbody>tr")).forEach((function(e,t){Array.from(e.querySelectorAll(":scope>td")).forEach((function(e,n){var r=parseInt(e.style.height),a=u.b.toSlateNode(o,e);d.b.isElement(a)&&a.height!=r&&d.h.setNodes(o,{height:r},{at:[].concat(Object(O.a)(j[1]),[t,n])})}))})),document.removeEventListener("mousemove",I),document.removeEventListener("mouseup",e)}))}}}}})]})]}))},F={editTd:function(e,t){F.deselectAllTd(e);var n=d.a.above(e,{at:t[1],mode:"highest",match:function(e){return H.isTd(e)}});d.h.setNodes(e,{canTdEdit:!0,start:!0},{at:d.a.range(e,n?n[1]:t[1]),mode:"all",hanging:!0,match:function(e){return H.isTd(e)}}),d.h.select(e,t[1]),D({row:t[1][t[1].length-2],col:t[1][t[1].length-1]})},getTdMap:function(e){for(var t=e[0].children,n=[],r=new Array(t.length).fill(0).map((function(){return[]})),a=0;a<t.length;a++)for(var i=t[a].children,o=0;o<i.length;o++){var c=i[o];if(H.isTd(c)){var s=r[a].findIndex((function(e){return null==e})),d=(s=-1==s?r[a].length:s)+(c.colSpan||1),u=a,f=u+(c.rowSpan||1),h=Object(l.a)(Object(l.a)({},c),{},{colSpan:c.colSpan||1,rowSpan:c.rowSpan||1,row:a,col:s,originRow:a,originCol:o});c.start&&n.push(h);for(var b=u;b<f;b++)for(var j=s;j<d;j++)r[b][j]=h}}return{tdMap:r,startPoins:n}},getSelectedTdInTdMap:function(e){var t=F.getTdMap(e),n=t.tdMap,r=t.startPoins;if(r.length<1)return null;if(1==r.length&&(r[1]=r[0]),!n)return null;var a=Object(s.a)(r,2),i=a[0],o=a[1],c=new Map([[i,1],[o,1]]);return function e(t,r){for(var a=t.colStart,i=t.colEnd,o=t.rowStart,c=t.rowEnd,l=o;l<c;l++)for(var s=a;s<i;s++){var d=n[l][s];if(!r.has(d))return r.set(d,1),void e({colStart:Math.min(d.col,a),colEnd:Math.max(i,d.col+d.colSpan),rowStart:Math.min(d.row,o),rowEnd:Math.max(d.row+d.rowSpan,c)},r)}}({colStart:Math.min(i.col,o.col),colEnd:Math.max(i.col+i.colSpan,o.col+o.colSpan),rowStart:Math.min(i.row,o.row),rowEnd:Math.max(i.row+i.rowSpan,o.row+o.rowSpan)},c),c},getEditingTd:function(e){var t=d.a.nodes(e,{at:[],match:function(e){return H.isTd(e)&&1==e.canTdEdit}});return Object(s.a)(t,1)[0]},deselectAllTd:function(e){var t,n=H.getSelectedTdsPath(e),r=Object(v.a)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;d.h.unsetNodes(e,["selected","start","canTdEdit"],{at:a})}}catch(s){r.e(s)}finally{r.f()}L(new Set);var i,o=H.getEditingTdsPath(e),c=Object(v.a)(o);try{for(c.s();!(i=c.n()).done;){var l=i.value.split(",").map((function(e){return+e}));d.h.unsetNodes(e,["selected","start","canTdEdit"],{at:l})}}catch(s){c.e(s)}finally{c.f()}k(new Set),D(null)},findTargetTd:function(e,t,n){if(t){var a=d.a.above(e,{at:t[1],mode:"lowest",match:function(e){return d.b.isElement(e)&&e.type==r.TBODY}});if(a&&d.b.isElement(a[0])){var i,o,c=F.getTdMap(a).tdMap,l=T.preSelectedTdPos;if(l)if(c.some((function(e,t){return e.some((function(e,n){return 1==e.start&&(i=t,o=n,!0)}))})),null!=i&&null!=o){var s=c[i][o];F.deselectAllTd(e);var u=l.col,f=l.row;if("left"==n)u=0==o?0==i?0:(f=l.row-1,c[0].length-1):o-1;else if("right"==n){var h=o+s.colSpan;u=h>=c[0].length?i==c.length-1?o:(f=l.row+1,0):h}else"up"==n?f=0==i?0:i-1:"down"==n&&(f=i+s.rowSpan>=c.length?i:i+s.rowSpan);var b=c[f][u];D({row:f,col:u}),d.h.setNodes(e,{selected:!0,start:!0},{at:[].concat(Object(O.a)(a[1]),[b.originRow,b.originCol])})}}}},chooseTd:function(e,t){F.deselectAllTd(e),d.h.deselect(e),d.h.setNodes(e,{selected:!0,start:!0,canTdEdit:!1},{at:t[1]}),D({row:t[1][t[1].length-2],col:t[1][t[1].length-1]})},clearTd:function(e){var t,n=H.getSelectedTds(e),r=Object(v.a)(n);try{for(r.s();!(t=r.n()).done;){var a,i=Object(s.a)(t.value,2)[1],o=Object(v.a)(d.c.children(e,i,{reverse:!0}));try{for(o.s();!(a=o.n()).done;){var c=Object(s.a)(a.value,2)[1];d.h.removeNodes(e,{at:c})}}catch(l){o.e(l)}finally{o.f()}d.h.unsetNodes(e,["selected","start"],{at:i})}}catch(l){r.e(l)}finally{r.f()}}},B=n(205),_=function(e){var t=e.attributes,n=e.children,i=e.element,o=Object(a.useRef)({isBeginSelectTd:!1,mouseDownStartPoint:null,initX:0,initY:0,lastSelectedPaths:[],preMouseOnTdPath:null,prePath:null}),c=Object(a.useContext)(Jt),f=c.savedMarks,b=c.setSavedMarks,j=Object(u.g)(),p=Object(u.d)();Object(a.useEffect)((function(){!function(){var e=t.ref.current;if(e){var n=(null===e||void 0===e?void 0:e.offsetWidth)-2,r=i.wrapperWidthWhenCreated,a=e.querySelector(":scope>table");if(a&&null!=n&&null!=r&&r!=n){var o=u.b.toSlateNode(j,e);if(!o)return;var c=u.b.findPath(j,o);if(!c)return;Array.from(a.querySelectorAll(":scope>tbody>tr")).forEach((function(e,t){Array.from(e.querySelectorAll(":scope>td")).forEach((function(e,a){var i=u.b.toSlateNode(j,e);if(d.b.isElement(i)){var o=(i.width||P)/r*n;d.h.setNodes(j,{width:o},{at:[].concat(Object(O.a)(c),[0,t,a])})}}))})),d.h.setNodes(j,{wrapperWidthWhenCreated:n},{at:c})}}}();var e=u.b.findPath(j,i);null==o.current.prePath||d.e.equals(e,o.current.prePath)||H.resetSelectedTds(j),o.current.prePath=e}));var g=m.a.debounce((function(e,t){var n=d.c.common(j,e.path,t.path);if(n){var a=d.a.above(j,{at:t,mode:"lowest",match:function(e){return H.isTd(e)}});if(a){var i=o.current.preMouseOnTdPath;if(!i||!d.e.equals(i,a[1])){o.current.preMouseOnTdPath=a[1];var c=d.a.above(j,{at:e,mode:"lowest",match:function(e){return H.isTd(e)}});if(c){var l=function(){o.current.lastSelectedPaths.forEach((function(e){d.h.unsetNodes(j,["selected","start"],{at:e})})),o.current.lastSelectedPaths=[]};if(o.current.lastSelectedPaths.forEach((function(e){var t=d.a.node(j,e);t&&d.b.isElement(t[0])&&1==t[0].start&&d.h.unsetNodes(j,["start"],{at:e})})),d.e.equals(c[1],a[1]))return l(),void d.h.setNodes(j,{selected:!0,start:!0},{at:c[1]});if(!d.b.isElement(n[0])||n[0].type!=r.TBODY&&n[0].type!=r.TR)l();else{var s=d.a.above(j,{at:e,mode:"highest",match:function(e,t){return H.isTd(e)&&t.length>n[1].length}});if(s){d.h.setNodes(j,{start:!0,selected:!0},{at:s[1]});var u=d.a.above(j,{at:t,mode:"highest",match:function(e,t){return H.isTd(e)&&t.length>n[1].length}});if(u){d.h.setNodes(j,{start:!0,selected:!0},{at:u[1]});var f=d.a.above(j,{at:s[1],mode:"lowest",match:function(e){return d.b.isElement(e)&&e.type==r.TBODY}});if(f&&d.b.isElement(f[0])){var h=F.getSelectedTdInTdMap(f);if(null!=h){var b,p=Array.from(h.keys()).map((function(e){return[].concat(Object(O.a)(f[1]),[e.originRow,e.originCol])})),m=function(e,t){var n=new Set(e.map((function(e){return e.slice(e.length-2).join(",")}))),r=new Set(t.map((function(e){return e.slice(e.length-2).join(",")})));return{deselectedPath:t.filter((function(e){return!n.has(e.slice(e.length-2).join(","))})),newSelectedPath:e.filter((function(e){return!r.has(e.slice(e.length-2).join(","))}))}}(p,o.current.lastSelectedPaths),g=m.deselectedPath,y=m.newSelectedPath,x=Object(v.a)(y);try{for(x.s();!(b=x.n()).done;){var T=b.value;d.h.setNodes(j,{selected:!0},{at:T})}}catch(N){x.e(N)}finally{x.f()}var w,S=Object(v.a)(g);try{for(S.s();!(w=S.n()).done;){var E=w.value;d.h.unsetNodes(j,["selected","start"],{at:E})}}catch(N){S.e(N)}finally{S.f()}o.current.lastSelectedPaths=p}}}}}}}}}}),5);return Object(A.jsx)("div",Object(l.a)(Object(l.a)({},t),{},{style:{display:"inline-block",position:"relative",width:"100%",overflowX:"auto",overflowY:"hidden"},children:Object(A.jsx)("table",Object(l.a)(Object(l.a)({border:"1"},t),{},{style:{tableLayout:"auto",wordBreak:"break-all",overflowX:"auto",overflowY:"hidden",borderCollapse:"collapse"},onMouseDown:function(e){e.stopPropagation();try{var t=u.b.toSlateNode(j,e.target),n=u.b.findPath(j,t);o.current.initX=e.clientX,o.current.initY=e.clientY,o.current.preMouseOnTdPath=null,o.current.lastSelectedPaths=[];var r=e.nativeEvent.path.find((function(e){return"TD"==e.tagName}));if(!r)return;if(!p&&!["resizer","columnSelector"].includes(e.target.className)&&"false"===r.contentEditable){o.current.isBeginSelectTd=!0,o.current.mouseDownStartPoint=n;var a,i=Object(v.a)(d.a.nodes(j,{at:[],match:function(e){return H.isTd(e)&&(1==e.selected||1==e.start)}}));try{for(i.s();!(a=i.n()).done;){var c=Object(s.a)(a.value,2)[1];o.current.lastSelectedPaths.push(c)}}catch(l){i.e(l)}finally{i.f()}o.current.preMouseOnTdPath=n;window.onmousemove=function(e){try{if(o.current.isBeginSelectTd&&(Math.abs(e.clientX-o.current.initX)>1||Math.abs(e.clientY-o.current.initY)>1)){var t=u.b.toSlateNode(j,e.target),n=u.b.findPath(j,t);g(d.a.point(j,o.current.mouseDownStartPoint),d.a.point(j,n))}}catch(r){}},window.onmouseup=function(e){o.current.isBeginSelectTd=!1,window.onmousemove=function(){},window.onmousedown=function(){},window.onmouseup=function(){}}}}catch(f){}},onMouseUp:function(){if(f){for(var e={},t=H.getSelectedTdsSize(j),n=0,r=Object.values(h);n<r.length;n++){var a=r[n];e[a]=f[a]}if(t>0){var i,o=H.getSelectedTdsPath(j),c=Object(v.a)(o);try{for(c.s();!(i=c.n()).done;){var l=i.value;d.h.setNodes(j,e,{at:l})}}catch(s){c.e(s)}finally{c.f()}return void b(null)}}},children:n}))}))},W=function(e){var t,n=H.getFirstSelectedTd(e);return n?t=d.a.above(e,{mode:"lowest",at:n[1],match:function(e){return H.isTable(e)}}):e.selection&&(t=d.a.above(e,{mode:"lowest",match:function(e){return H.isTable(e)}})),t},H={model:[{type:r.TABLE,children:[{type:r.TBODY,children:new Array(100).fill(0).map((function(e,t){return{type:r.TR,children:new Array(10).fill(0).map((function(e,n){return{type:r.TD,width:100,height:50,children:[{type:r.DIV,children:[{text:"string".concat(t,"-").concat(n)}]}]}}))}}))}]},{type:r.DIV,children:[{text:"1"}]}],isSelectedTd:function(e){return H.isTd(e)&&1==e.selected},isTable:function(e){return d.b.isElement(e)&&r.TABLE==e.type},isTd:function(e){return d.b.isElement(e)&&[r.TD].includes(e.type)},isInTd:function(e){return!(!e.selection||!d.f.isCollapsed(e.selection))&&x.getFirstAboveElementType(e)==r.TD},normalizeTable:function(e,t){var n=Object(s.a)(t,2),a=n[0],i=n[1];if(d.b.isElement(a)&&[r.TABLE].includes(a.type)){var o,c=Object(v.a)(d.c.children(e,i,{reverse:!0}));try{for(c.s();!(o=c.n()).done;){var l=Object(s.a)(o.value,2),u=l[0],f=l[1];if(u.type!=r.TBODY)return void d.h.removeNodes(e,{at:f})}}catch(z){c.e(z)}finally{c.f()}}if(d.b.isElement(a)&&[r.TBODY].includes(a.type)){var h=x.getParent(e,i),b=Object(s.a)(h,1)[0];if(!d.b.isElement(b)||b.type!=r.TABLE)return d.h.removeNodes(e,{at:i}),!0;var j,p=Object(v.a)(d.c.children(e,i,{reverse:!0}));try{for(p.s();!(j=p.n()).done;){var m=Object(s.a)(j.value,2),g=m[0],y=m[1];if(g.type!=r.TR)return void d.h.removeNodes(e,{at:y})}}catch(z){p.e(z)}finally{p.f()}}if(d.b.isElement(a)&&r.TR==a.type){var T=x.getParent(e,i),w=Object(s.a)(T,1)[0];if(!d.b.isElement(w)||![r.TBODY].includes(w.type))return d.h.removeNodes(e,{at:i}),!0;var S,E=Object(v.a)(d.c.children(e,i,{reverse:!0}));try{for(E.s();!(S=E.n()).done;){var N=Object(s.a)(S.value,2),D=N[0],C=N[1];if(D.type!=r.TD)return void d.h.removeNodes(e,{at:C})}}catch(z){E.e(z)}finally{E.f()}if(1==a.children.length&&d.c.child(a,0).type!=r.TD)return d.h.setNodes(e,{shouldEmpty:!0},{at:i}),!0;if(a.children.length>1){var L,I=Object(v.a)(d.c.children(e,i,{reverse:!0}));try{for(I.s();!(L=I.n()).done;){var M=Object(s.a)(L.value,2),k=M[0],A=M[1];if(d.g.isText(k))return d.h.removeNodes(e,{at:A}),!0}}catch(z){I.e(z)}finally{I.f()}}return d.h.setNodes(e,{shouldEmpty:!1},{at:i}),!0}if(d.b.isElement(a)&&r.TD==a.type){var P=x.getParent(e,i),R=Object(s.a)(P,1)[0];if(!d.b.isElement(R)||![r.TR].includes(R.type))return d.h.removeNodes(e,{at:i}),!0;if(1==a.children.length&&d.g.isText(d.c.child(a,0))&&""==d.a.string(e,i,{voids:!0}))return d.h.wrapNodes(e,{type:r.DIV,children:[{text:""}]},{at:[].concat(Object(O.a)(i),[0])}),!0}},tabEvent:function(e){var t=F.getEditingTd(e);t&&(d.h.deselect(e),F.findTargetTd(e,t,"right"))},shiftTabEvent:function(e){var t=F.getEditingTd(e);t&&(d.h.deselect(e),F.findTargetTd(e,t,"left"))},deleteRow:function(e){var t,n=[1/0,-1/0],a=H.getFirstSelectedTd(e);if(a){var i=d.a.above(e,{at:a[1],match:function(e){return d.b.isElement(e)&&e.type==r.TBODY}});if(i){var o=F.getTdMap(i).tdMap;if(o){var c=Array.from((null===(t=F.getSelectedTdInTdMap(i))||void 0===t?void 0:t.keys())||[]);if(0!=c.length)if(c.forEach((function(e){n[0]=Math.min(n[0],e.row),n[1]=Math.max(n[1],e.row+e.rowSpan)})),n[1]-n[0]!=o.length){for(var l=[],s=n[0];s<n[1];s++){l.unshift([].concat(Object(O.a)(i[1]),[s]));for(var u=0;u<o[s].length;u++){var f=o[s][u];f.rowSpan--;var h=[].concat(Object(O.a)(i[1]),[f.originRow,f.originCol]);0!=f.rowSpan&&d.h.setNodes(e,{rowSpan:f.rowSpan},{at:h}),u+=f.colSpan-1}}for(var b=n[0];b<n[1];b++)for(var j=0;j<o[b].length;j++){var v=o[b][j];if(v.rowSpan>0&&v.row>=n[0]&&v.row==b&&v.col==j){var p=n[1],m=o[p][v.col-1];m?d.h.moveNodes(e,{at:[].concat(Object(O.a)(i[1]),[v.originRow,v.originCol]),to:[].concat(Object(O.a)(i[1]),[p,m.originCol+1])}):d.h.moveNodes(e,{at:[].concat(Object(O.a)(i[1]),[v.originRow,v.originCol]),to:[].concat(Object(O.a)(i[1]),[p,0])})}j+=v.colSpan-1}l.forEach((function(t){d.h.removeNodes(e,{at:t})})),H.resetSelectedTds(e)}else d.h.removeNodes(e,{at:d.e.parent(i[1])})}}}},deleteColumn:function(e){var t,n=[1/0,-1/0],a=H.getFirstSelectedTd(e);if(a){var i=d.a.above(e,{at:a[1],match:function(e){return d.b.isElement(e)&&e.type==r.TBODY}});if(i){var o=F.getTdMap(i).tdMap;if(o){var c=Array.from((null===(t=F.getSelectedTdInTdMap(i))||void 0===t?void 0:t.keys())||[]);if(0!=c.length)if(c.forEach((function(e){n[0]=Math.min(n[0],e.col),n[1]=Math.max(n[1],e.col+e.colSpan)})),n[1]-n[0]!=o[0].length){for(var l=[],s=n[0];s<n[1];s++)for(var u=0;u<o.length;u++){var f=o[u][s];f.colSpan--;var h=[].concat(Object(O.a)(i[1]),[f.originRow,f.originCol]);0==f.colSpan?l.push(h):d.h.setNodes(e,{colSpan:f.colSpan},{at:h}),u+=f.rowSpan-1}l.sort((function(e,t){var n=e[e.length-2],r=t[t.length-2],a=e[e.length-1],i=t[t.length-1];return n>r?-1:n==r?i-a:1})),l.forEach((function(t){d.h.removeNodes(e,{at:t})})),H.resetSelectedTds(e)}else d.h.removeNodes(e,{at:d.e.parent(i[1])})}}}},insertColumn:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=H.getFirstSelectedTd(e);if(!a&&e.selection){var i=d.a.nodes(e,{mode:"lowest",match:function(e){return H.isTd(e)}}),o=Object(s.a)(i,1);a=o[0]}if(a){var c=d.a.parent(e,a[1]);if(c){var l=d.a.parent(e,c[1]);if(l){var f=F.getTdMap(l),h=f.tdMap,b=F.getSelectedTdInTdMap(l);if(d.b.isElement(a[0])&&d.b.isElement(a[0])&&d.b.isElement(l[0])){var j,p=u.b.toDOMNode(e,e),g=function(){return m.a.cloneDeep(new Array(n).fill(0).map((function(){return m.a.cloneDeep({type:r.TD,width:p.offsetWidth/10,height:R,children:[{type:r.DIV,children:[{text:""}]}]})})))},y=a[1].slice(a[1].length-2),x=Object(s.a)(y,2),T=x[0],w=x[1];if(b&&b.size>0){j="after"==t?-1/0:1/0;var S,E=Object(v.a)(b.keys());try{for(E.s();!(S=E.n()).done;){var N=S.value;j="after"==t?Math.max(j,N.col+N.colSpan):Math.min(j,N.col)}}catch(B){E.e(B)}finally{E.f()}}else{j=-1;for(var D=0;D<h[T].length;D++){var C=h[T][D];if(C.originCol==w&&C.originRow==T){j=C.col+("after"==t?C.colSpan:0);break}}}if(null!=j&&Number.isFinite(j)){for(var L=0;L<h.length;L++){var I=h[L][j];if(I){var M=[].concat(Object(O.a)(l[1]),[I.originRow,I.originCol]);I.col==j?d.h.insertNodes(e,g(),{at:[].concat(Object(O.a)(l[1]),[L,I.originCol])}):(d.h.setNodes(e,{colSpan:I.colSpan+1},{at:M}),L+=I.rowSpan-1)}else{var k,A,P,z;d.h.insertNodes(e,g(),{at:[].concat(Object(O.a)(l[1]),[L,(null===(k=l[0])||void 0===k||null===(A=k.children)||void 0===A||null===(P=A[L])||void 0===P||null===(z=P.children)||void 0===z?void 0:z.length)||0])})}}H.resetSelectedTds(e)}}}}}},insertRow:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=H.getFirstSelectedTd(e);if(!a&&e.selection){var i=d.a.nodes(e,{mode:"lowest",match:function(e){return H.isTd(e)}}),o=Object(s.a)(i,1);a=o[0]}if(a){var c=d.a.parent(e,a[1]);if(c){var l=d.a.parent(e,c[1]);if(l){var f=F.getTdMap(l),h=f.tdMap,b=F.getSelectedTdInTdMap(l);if(d.b.isElement(a[0])&&d.b.isElement(a[0])&&d.b.isElement(l[0])){var j,p=u.b.toDOMNode(e,e),g={type:r.TD,width:p.offsetWidth/10,height:R,children:[{type:r.DIV,children:[{text:""}]}]},y=a[1].slice(a[1].length-2),x=Object(s.a)(y,2),T=x[0],w=x[1];if(b&&b.size>0){j="after"==t?-1/0:1/0;var S,E=Object(v.a)(b.keys());try{for(E.s();!(S=E.n()).done;){var N=S.value;j="after"==t?Math.max(j,N.row+N.rowSpan):Math.min(j,N.row)}}catch(A){E.e(A)}finally{E.f()}}else{j=-1;for(var D=0;D<h[T].length;D++){var C=h[T][D];if(C.originCol==w&&C.originRow==T){j=C.row+("after"==t?C.rowSpan:0);break}}}if(-1!=j&&Number.isFinite(j)){var L=function(e){return new Array(n).fill(0).map((function(){return m.a.cloneDeep({type:r.TR,children:new Array(e).fill(0).map((function(){return m.a.cloneDeep(g)}))})}))};if(null!=h[j]){for(var I=0,M=0;M<h[j].length;M++){var k=h[j][M];k.row==j?I++:(d.h.setNodes(e,{rowSpan:k.rowSpan+1},{at:[].concat(Object(O.a)(l[1]),[k.originRow,k.originCol])}),M+=k.colSpan-1)}d.h.insertNodes(e,L(I),{at:[].concat(Object(O.a)(l[1]),[j])}),H.resetSelectedTds(e)}else d.h.insertNodes(e,L(h[0].length),{at:[].concat(Object(O.a)(l[1]),[j])})}}}}}},splitTd:function(e){var t=d.a.nodes(e,{at:[],match:function(e){return H.isSelectedTd(e)}});if(t){var n,a=null,i=Object(v.a)(t);try{var o=function(){var t=Object(s.a)(n.value,2),i=t[0],o=t[1];if(!d.b.isElement(i))return"continue";if(d.h.setNodes(e,{colSpan:1,rowSpan:1},{at:o}),d.h.unsetNodes(e,["selected","start"],{at:o}),(!i.colSpan||i.colSpan<2)&&(!i.rowSpan||i.rowSpan<2))return"continue";if(!a&&!(a=d.a.above(e,{at:o,mode:"lowest",match:function(e){return d.b.isElement(e)&&e.type==r.TBODY}})))return"continue";for(var c=d.a.parent(e,o),l=o[o.length-1],u=o[o.length-2],f=i.colSpan||1,h=i.rowSpan||1,b=0,j=0;j<l;j++){var v,p,g;b+=(null===(v=c[0])||void 0===v||null===(p=v.children)||void 0===p||null===(g=p[j])||void 0===g?void 0:g.colSpan)||1}for(var y=function(e){for(var t=0,n=0;n<e[0].children.length;n++)if((t+=e[0].children[n].colSpan||1)==b)return n+1;return 0},x=u,T=0;T<h;T++,x++){var w=x==u,S=y(d.a.node(e,[].concat(Object(O.a)(a[1]),[x]))),E=f-(w?1:0);d.h.insertNodes(e,new Array(E).fill(0).map((function(){return m.a.cloneDeep({type:r.TD,children:[{type:r.DIV,children:[{text:""}]}]})})),{at:[].concat(Object(O.a)(a[1]),[x,S+(w?1:0)])})}return H.splitTd(e),H.resetSelectedTds(e),{v:void 0}};for(i.s();!(n=i.n()).done;){var c=o();if("continue"!==c&&"object"===typeof c)return c.v}}catch(l){i.e(l)}finally{i.f()}}},mergeTd:function(e){var t=1==H.getSelectedTdsSize(e),n=H.getFirstSelectedTd(e);if(n&&null!=t){var a=d.a.above(e,{at:n[1],mode:"lowest",match:function(e){return d.b.isElement(e)&&e.type==r.TBODY}});if(a){var i=F.getSelectedTdInTdMap(a);if(i){var o=a[1],c=Array.from(null===i||void 0===i?void 0:i.keys());c.sort((function(e,t){return e.row>t.row?1:e.row==t.row?e.col-t.col:-1}));var l=c[0],u=0,f=0;c.forEach((function(e){u=Math.max(u,e.colSpan+e.col-l.col),f=Math.max(f,e.rowSpan+e.row-l.row)}));var h=[].concat(Object(O.a)(o),[l.originRow,l.originCol]);d.h.setNodes(e,{colSpan:u,rowSpan:f},{at:h});var b=d.a.node(e,h);c.forEach((function(t){if(t.col!=l.col||t.row!=l.row){var n,r=[].concat(Object(O.a)(o),[t.originRow,t.originCol]),a=Object(v.a)(d.c.children(e,r,{reverse:!0}));try{for(a.s();!(n=a.n()).done;){var i=Object(s.a)(n.value,2)[1];""!=d.a.string(e,i,{voids:!0})&&d.h.moveNodes(e,{at:i,to:[].concat(Object(O.a)(b[1]),[b[0].children.length])})}}catch(c){a.e(c)}finally{a.f()}d.h.setNodes(e,{toBeDeleted:!0},{at:r})}})),d.h.removeNodes(e,{at:[],match:function(e){return H.isTd(e)&&1==e.toBeDeleted}}),H.resetSelectedTds(e)}}}},deleteTable:function(e){var t=W(e);t&&(d.h.removeNodes(e,{at:t[1]}),H.resetSelectedTds(e))},insertDivAfterTable:function(e){var t=W(e);if(t){var n=x.getPath(t[1],"next");d.h.insertNodes(e,{type:r.DIV,children:[{text:"write something..."}]},{at:n}),H.resetSelectedTds(e)}},insertDivBeforeTable:function(e){var t=W(e);t&&(d.h.insertNodes(e,{type:r.DIV,children:[{text:"write something..."}]},{at:t[1]}),H.resetSelectedTds(e))},getSelectedTdsPath:function(e){var t,n=C(e),r=[],a=Object(v.a)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value.split(",").map((function(e){return+e}));r.push(i)}}catch(o){a.e(o)}finally{a.f()}return r},getSelectedTds:function(e){var t,n=C(e),r=[],a=Object(v.a)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value.split(",").map((function(e){return+e})),o=d.a.node(e,i);r.push(o)}}catch(c){a.e(c)}finally{a.f()}return r},getFirstSelectedTd:function(e){var t=C(e),n=Array.from(t).sort((function(e,t){return e>t?1:e===t?0:-1}));if(0==n.length)return null;var r=n[0].split(",").map((function(e){return+e}));return d.a.node(e,r)},getEditingTds:function(e){var t,n=M(e),r=[],a=Object(v.a)(n);try{for(a.s();!(t=a.n()).done;){var i=t.value.split(",").map((function(e){return+e}));r.push(d.a.node(e,i))}}catch(o){a.e(o)}finally{a.f()}return r},getEditingTdsPath:function(e){return M(e)},getSelectedTdsSize:function(e){return C(e).size},resetSelectedTds:function(e){var t=Array.from(d.a.nodes(e,{at:[],match:function(e){return H.isSelectedTd(e)}})).map((function(e){return e[1].join(",")}));L(new Set(t));var n=Array.from(d.a.nodes(e,{at:[],match:function(e){return H.isTd(e)&&1==e.canTdEdit}})).map((function(e){return e[1].join(",")}));k(new Set(n))},copyCells:function(e){var t,n=H.getSelectedTds(e);S(n.sort((function(e,t){var n=e[1].slice(e[1].length-2),r=Object(s.a)(n,2),a=r[0],i=r[1],o=t[1].slice(t[1].length-2),c=Object(s.a)(o,2),l=c[0],d=c[1];return a>l?1:a===l?i-d:-1})));var a=d.a.above(e,{at:n[0][1],mode:"lowest",match:function(e){return d.b.isElement(e)&&e.type===r.TBODY}});if(a){var i=Array.from((null===(t=F.getSelectedTdInTdMap(a))||void 0===t?void 0:t.keys())||[]),o=F.getTdMap(a).startPoins,c=0,l=0;i.forEach((function(e){var t=e.row,n=e.col;c=Math.max(n+(e.colSpan||1)-o[0].col,c),l=Math.max(t+(e.rowSpan||1)-o[0].row,l)})),N({copyedAreaWidth:c,copyedAreaHeight:l})}},pasteCells:function(e){var t=T.copyedContent;if(t){var n=Array.from(H.getSelectedTdsPath(e));F.clearTd(e);for(var a=0,i=n;a<i.length;a++){var o=i[a];d.h.insertNodes(e,m.a.cloneDeep(t),{at:[].concat(Object(O.a)(o),[0])}),d.h.removeNodes(e,{at:[].concat(Object(O.a)(o),[Array.from(d.c.children(e,o)).length-1])})}}else{var c=E();if(c){var u={copyedAreaHeight:T.copyedAreaHeight,copyedAreaWidth:T.copyedAreaWidth},f=u.copyedAreaWidth,h=u.copyedAreaHeight,b=Array.from(H.getSelectedTds(e)),j=d.a.above(e,{at:b[0][1],mode:"lowest",match:function(e){return d.b.isElement(e)&&e.type===r.TBODY}});if(j)if(1!=c.length){var p=F.getTdMap(j),g=p.tdMap,y=p.startPoins[0];if(y.row+h>g.length||y.col+f>g[0].length)return B.b.error("\u65e0\u6cd5\u5b8c\u6574\u8986\u76d6\u76ee\u6807\u533a\u57df"),!1;for(var x=[],w=y.row;w<g.length&&w<y.row+h;w++)for(var S=y.col;S<g[0].length&&S<y.col+f;S++){var N=g[w][S];if(x.unshift([N.originRow,N.originCol]),N.col<y.col||N.col+N.colSpan>y.col+f||N.row<y.row||N.row+N.rowSpan>y.row+h)return B.b.error("\u65e0\u6cd5\u5b8c\u6574\u8986\u76d6\u76ee\u6807\u533a\u57df"),!1}m.a.uniqWith(x,(function(e,t){return e.join(",")===t.join(",")})).forEach((function(t){d.h.removeNodes(e,{at:[].concat(Object(O.a)(j[1]),Object(O.a)(t))})}));for(var D=c.slice().reduce((function(e,t){return Math.min(e,t[1][t[1].length-2])}),1/0),C=function(t,n){var r=g[n][y.col],a=[];c.forEach((function(e){var n=e[1];n[n.length-2]===t&&a.push(Object(l.a)(Object(l.a)({},e[0]),{},{selected:!1,start:!1,canTdEdit:!1}))})),a.length>0&&d.h.insertNodes(e,m.a.cloneDeep(a),{at:[].concat(Object(O.a)(j[1]),[n,r.originCol])})},L=y.row,I=D;L<y.row+h;L++,I++)C(I,L);F.deselectAllTd(e),H.resetSelectedTds(e)}else{var M=c[c.length-1];if(!M)return;b.forEach((function(t){var n=t[0].children.length;d.h.insertNodes(e,m.a.cloneDeep(M[0].children),{at:[].concat(Object(O.a)(t[1]),[0])});var r,a=Object(v.a)(d.c.children(e,t[1],{reverse:!0}));try{for(a.s();!(r=a.n()).done;){var i=Object(s.a)(r.value,2)[1];if(0==n--)break;d.h.removeNodes(e,{at:i})}}catch(o){a.e(o)}finally{a.f()}}))}}}}},Y=n(371),U=n(372),V=n(373),q=n(407),K=(n(223),n(370)),G=n(121),X=n(85),J=function(e){return Object(A.jsx)(G.a,{title:e.title,mouseEnterDelay:0,mouseLeaveDelay:0,children:Object(A.jsx)(X.a,{className:"cyEditor__toolbar__button",type:"text",disabled:e.disabled,onMouseDown:function(t){t.preventDefault(),e.mousedownFunc(t)},children:e.children})})},$=function(){var e=Object(u.g)();return Object(A.jsx)(J,{title:"\u6e05\u9664\u683c\u5f0f",mousedownFunc:function(){!function(e){var t=H.getSelectedTds(e);if(t.length>0){var n,r=Object(v.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;d.h.unsetNodes(e,Object.values(h),{at:a[1]})}}catch(b){r.e(b)}finally{r.f()}}else{var i,o=d.a.nodes(e,{mode:"lowest",match:function(e){return x.isTextWrapper(e)}}),c=Object(v.a)(o);try{for(c.s();!(i=c.n()).done;){var l=i.value;d.h.unsetNodes(e,Object.values(h),{at:l[1]})}}catch(b){c.e(b)}finally{c.f()}for(var s=0,u=Object.values(h);s<u.length;s++){var f=u[s];d.a.removeMark(e,f)}}}(e)},children:Object(A.jsx)(K.a,{component:function(){return Object(A.jsxs)("svg",{viewBox:"0 0 1084 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"853",width:"14",height:"14",children:[Object(A.jsx)("defs",{children:Object(A.jsx)("style",{type:"text/css"})}),Object(A.jsx)("path",{d:"M719.329882 422.249412l-255.578353 255.578353 234.315295 234.315294 255.518117-255.638588-234.315294-234.255059zM59.151059 315.813647l298.164706-298.164706a60.235294 60.235294 0 0 1 85.172706 0l596.329411 596.329412a60.235294 60.235294 0 0 1 0 85.172706l-298.164706 298.164706a60.235294 60.235294 0 0 1-85.232941 0l-596.329411-596.329412a60.235294 60.235294 0 0 1 0-85.172706z",fill:"#333333","p-id":"854"})]})}})})},Q=n(380),Z=50,ee=function(e){var t=Object(u.f)(),n=Object(a.useContext)(Jt).setSavedMarks,r=Object(a.useState)(!1),i=Object(s.a)(r,2),o=i[0],c=i[1],f=Object(a.useRef)({isDisabled:m.a.debounce((function(){var e=H.getSelectedTdsSize(t)>1,n=H.getFirstSelectedTd(t);c(!(null!=t.selection||n&&!e))}),Z)});Object(a.useEffect)((function(){f.current.isDisabled()}));return Object(a.useMemo)((function(){return Object(A.jsx)(J,{title:"\u683c\u5f0f\u5237",disabled:o,mousedownFunc:function(){!function(){try{var e=H.getSelectedTdsSize(t)>1,r=H.getFirstSelectedTd(t);if(r&&!e&&d.b.isElement(r[0]))return void n(r[0]||null);if(!t.selection)return null;var a=d.a.marks(t),i=d.a.above(t,{mode:"lowest",match:function(e){return x.isTextWrapper(e)}});n(i?Object(l.a)(Object(l.a)({},a),i[0])||null:a||null)}catch(o){console.warn(o)}}()},children:Object(A.jsx)(Q.a,{})})}),[o])},te=n(375),ne=function(e){var t=Object(u.f)(),n=Object(a.useState)(!1),r=Object(s.a)(n,2),i=r[0],o=r[1],c=Object(a.useState)(""),l=Object(s.a)(c,2),d=l[0],f=l[1],h=Object(a.useRef)(),b=Object(a.useRef)({getValue:m.a.debounce((function(){f(e.getValue(t))}),Z)});return Object(a.useEffect)((function(){b.current.getValue()})),Object(a.useMemo)((function(){return Object(A.jsx)(G.a,{title:e.title,zIndex:99,mouseEnterDelay:0,mouseLeaveDelay:0,children:Object(A.jsxs)("div",{ref:h,style:{width:100,position:"relative"},className:"cyEditor__toolbar__button",onMouseLeave:function(){o(!1)},children:[Object(A.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:1,cursor:"pointer"},onMouseDown:function(e){e.preventDefault(),o(!i)}}),Object(A.jsx)(te.a,{placeholder:e.title,value:d,bordered:!1,style:{width:"100%"},open:i,dropdownClassName:"cyEditor__toolbar__dropdown",getPopupContainer:function(e){return e.parentElement||document.body},onSelect:function(n){var r;u.b.focus(t),null===e||void 0===e||null===(r=e.afterSelect)||void 0===r||r.call(e,n),o(!1)},children:e.options.map((function(t){var n;return Object(A.jsx)(te.a.Option,{value:String(t),children:(null===e||void 0===e||null===(n=e.optionLabelRender)||void 0===n?void 0:n.call(e,t))||t},t)}))})]})})}),[i,d])},re=function(){var e=Object(u.g)();return Object(A.jsx)(ne,{getValue:function(e){var t=H.getFirstSelectedTd(e);if(t&&d.b.isElement(t[0]))return t[0][h.TextAlign]||"\u5de6\u5bf9\u9f50";var n=d.a.nodes(e,{match:function(e){return x.isTextWrapper(e)}}),r=Object(s.a)(n,1)[0];if(!r)return"\u5de6\u5bf9\u9f50";var a=d.b.isElement(r[0])&&r[0].textAlign;return!1===a||null==a?"left":a},options:["left","right","center"],optionLabelRender:function(e){return"left"===e?"\u5de6\u5bf9\u9f50":"right"===e?"\u53f3\u5bf9\u9f50":"center"===e?"\u5c45\u4e2d\u5bf9\u9f50":"".concat(e)},title:"\u5bf9\u9f50\u65b9\u5f0f",afterSelect:function(t){u.b.focus(e);var n=H.getSelectedTds(e);if(n.length>0){var r,a=Object(v.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;d.h.setNodes(e,{textAlign:t},{at:i[1]})}}catch(o){a.e(o)}finally{a.f()}}else e.selection&&d.h.setNodes(e,{textAlign:t},{mode:"lowest",match:function(e){return x.isTextWrapper(e)}})}})},ae=function(){var e=Object(u.g)();return Object(A.jsx)(ne,{getValue:function(e){return String(function(e,t){try{var n=H.getFirstSelectedTd(e);if(n&&d.b.isElement(n[0]))return n[0][t];if(!e.selection)return null;var r=d.a.marks(e);return null===r||void 0===r?void 0:r[t]}catch(a){return console.error(a),!1}}(e,h.FontSize)||14)},options:[12,13,14,15,16,19,22,24,29,32,40,48],optionLabelRender:function(e){return"".concat(e,"px")},title:"\u5b57\u4f53\u5927\u5c0f",afterSelect:function(t){var n=H.getSelectedTds(e);if(n.length>0){var r,a=Object(v.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;d.h.setNodes(e,Object(c.a)({},h.FontSize,Number(t)),{at:i[1]})}}catch(o){a.e(o)}finally{a.f()}}else e.selection&&d.a.addMark(e,h.FontSize,Number(t))}})},ie=function(){var e=Object(u.g)(),t=function(t){var n=H.getSelectedTds(e);n.length>0?n.forEach((function(n){d.h.setNodes(e,{type:t},{at:n[1],match:function(e){return x.isTextWrapper(e)}})})):d.h.setNodes(e,{type:t},{hanging:!0,mode:"lowest",match:function(e){return x.isTextWrapper(e)}})};return Object(A.jsx)(ne,{getValue:function(e){var t=d.a.nodes(e,{match:function(e){return x.isTextWrapper(e)}}),n=Object(s.a)(t,1)[0];if(!n)return"\u6b63\u6587";var r=d.b.isElement(n[0])&&n[0].type;return"div"===r||!1===r?"\u6b63\u6587":r.toUpperCase()},options:["H1","H2","H3","H4","\u6b63\u6587"],optionLabelRender:function(e){return Object(A.jsx)("span",{children:e})},title:"\u5b57\u4f53\u6837\u5f0f",afterSelect:function(e){"H1"===e&&t(r.H1),"H2"===e&&t(r.H2),"H3"===e&&t(r.H3),"H4"===e&&t(r.H4),"\u6b63\u6587"===e&&t(r.DIV)}})},oe=n(382),ce=n(377),le=n(381),se=n(201),de=function(e){var t=Object(a.useState)({hex:e.value}),n=Object(s.a)(t,2),r=n[0],i=n[1];return Object(A.jsxs)("div",{style:{padding:8,display:"flex",justifyContent:"flex-start",backgroundColor:"white",flexDirection:"column"},className:"cyEditor__toolbar__colorPanelWrapper",children:[Object(A.jsx)(se.a,{color:r.hex,onChange:function(t){var n;i(t),null===e||void 0===e||null===(n=e.onChange)||void 0===n||n.call(e,t.hex)}}),Object(A.jsx)(X.a,{icon:Object(A.jsx)(le.a,{}),size:"small",onClick:function(){var t;null===e||void 0===e||null===(t=e.onChange)||void 0===t||t.call(e,"unset"),i({hex:""})},children:"\u91cd\u7f6e"})]})},ue=function(e){var t=Object(u.f)(),n=Object(a.useState)(""),r=Object(s.a)(n,2),i=r[0],o=r[1],c=Object(a.useState)(!1),l=Object(s.a)(c,2),f=l[0],h=l[1],b=Object(a.useRef)({_getColor:m.a.debounce((function(){o(j())}),Z)}),j=function(){var n=H.getFirstSelectedTd(t);if(n)return d.b.isElement(n[0])&&(n[0][e.mark]||"unset");if(!t.selection)return"unset";if(!e.mark)return"unset";var r=d.a.marks(t);return r&&(null===r||void 0===r?void 0:r[null===e||void 0===e?void 0:e.mark])||window.getComputedStyle(document.body).color};return Object(a.useEffect)((function(){b.current._getColor()})),Object(a.useMemo)((function(){return Object(A.jsx)(G.a,{title:e.title,zIndex:99,mouseLeaveDelay:0,mouseEnterDelay:0,children:Object(A.jsx)("div",{onMouseLeave:function(){h(!1)},children:Object(A.jsx)(ce.a,{placement:"bottomCenter",overlayStyle:{zIndex:999},visible:f,overlay:function(){return Object(A.jsx)(de,{value:i,onChange:function(t){var n;null===e||void 0===e||null===(n=e.onChange)||void 0===n||n.call(e,t),h(!1)}})},trigger:["click"],getPopupContainer:function(e){return e.parentElement||document.body},children:Object(A.jsx)(X.a,{type:"text",style:{color:i},onMouseDown:function(e){e.preventDefault(),h(!0)},children:e.icon})})})})}),[i,f])},fe=function(){var e=Object(u.g)();return Object(A.jsx)(ue,{title:"\u5b57\u4f53\u989c\u8272",onChange:function(t){u.b.focus(e);var n=H.getSelectedTds(e);if(n.length>0){var r,a=Object(v.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;d.h.setNodes(e,Object(c.a)({},h.Color,t),{at:i[1]})}}catch(o){a.e(o)}finally{a.f()}}else e.selection&&d.a.addMark(e,h.Color,t)},mark:h.Color,icon:Object(A.jsx)(oe.a,{})})},he=n(383),be=function(){var e=Object(u.g)();return Object(A.jsx)(ue,{title:"\u80cc\u666f\u8272",onChange:function(t){u.b.focus(e);var n=H.getSelectedTds(e);if(n.length>0){var r,a=Object(v.a)(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;d.h.setNodes(e,Object(c.a)({},h.BGColor,t),{at:i[1]})}}catch(o){a.e(o)}finally{a.f()}}else e.selection&&d.a.addMark(e,h.BGColor,t)},mark:h.BGColor,icon:Object(A.jsx)(he.a,{})})},je=n(384),ve=function(e){var t=Object(u.f)(),n=Object(a.useState)("text"),r=Object(s.a)(n,2),i=r[0],o=r[1],l=Object(a.useRef)({getType:m.a.debounce((function(){o(e.mark&&function(e,t){try{var n=H.getFirstSelectedTd(e);if(n&&d.b.isElement(n[0]))return n[0][t];if(!e.selection)return null;var r=d.a.marks(e);return!0===(null===r||void 0===r?void 0:r[t])}catch(a){return console.error(a),!1}}(t,e.mark)?"link":"text")}),Z)});Object(a.useEffect)((function(){l.current.getType()}));return Object(a.useMemo)((function(){return Object(A.jsx)(G.a,{title:e.title,mouseEnterDelay:0,mouseLeaveDelay:0,children:Object(A.jsx)(X.a,{className:"cyEditor__toolbar__button",type:i,onMouseDown:function(n){n.preventDefault(),e.mark&&function(e){var n=H.getSelectedTds(t);if(n.length>0)return u.b.focus(t),void n.forEach((function(n){d.b.isElement(n[0])&&(n[0][e]?d.h.unsetNodes(t,[e],{at:n[1]}):d.h.setNodes(t,Object(c.a)({},e,!0),{at:n[1]}))}));if(t.selection){var r=d.a.marks(t);(null===r||void 0===r?void 0:r[e])?d.a.removeMark(t,e):d.a.addMark(t,e,!0)}}(e.mark)},children:e.children})})}),[i])},Oe=function(){return Object(A.jsx)(ve,{title:"\u52a0\u7c97",mark:h.BOLD,children:Object(A.jsx)(je.a,{})})},pe=n(385),me=function(){return Object(A.jsx)(ve,{title:"\u659c\u4f53",mark:h.ITALIC,children:Object(A.jsx)(pe.a,{})})},ge=n(386),ye=function(){return Object(A.jsx)(ve,{title:"\u4e0b\u5212\u7ebf",mark:h.Underline,children:Object(A.jsx)(ge.a,{})})},xe=n(387),Te=function(){return Object(A.jsx)(ve,{title:"\u5220\u9664\u7ebf",mark:h.LineThrough,children:Object(A.jsx)(xe.a,{})})},we=n(388),Se=function(e){var t=Object(u.f)(),n=e.mousedownFunc,r=e.title,i=e.disabledCondition,o=void 0===i?function(){return!1}:i,c=Object(a.useState)(!1),l=Object(s.a)(c,2),d=l[0],f=l[1],h=Object(a.useRef)({_isDisabled:m.a.debounce((function(){f(o(t))}),Z)});return Object(a.useEffect)((function(){h.current._isDisabled()})),Object(A.jsx)(G.a,{title:r,mouseEnterDelay:0,mouseLeaveDelay:0,children:Object(A.jsx)(X.a,{className:"cyEditor__toolbar__button",type:"text",disabled:d,onMouseDown:function(e){e.preventDefault(),n(e)},children:e.children})})},Ee=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u5f85\u529e\u5217\u8868",mousedownFunc:function(){d.h.insertNodes(e,{type:r.TODOLIST,children:[{text:""}]})},disabledCondition:function(e){return null==e.selection},children:Object(A.jsx)(we.a,{})})},Ne=n(389),De=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u6709\u5e8f\u5217\u8868",mousedownFunc:function(){y.toggleList(e,r.NUMBER_LIST)},disabledCondition:function(e){return null==e.selection},children:Object(A.jsx)(Ne.a,{})})},Ce=n(390),Le=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u65e0\u5e8f\u5217\u8868",mousedownFunc:function(){y.toggleList(e,r.NORMAL_LIST)},disabledCondition:function(e){return null==e.selection},children:Object(A.jsx)(Ce.a,{})})},Ie=n(391),Me=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u8bbe\u7f6e\u94fe\u63a5",mousedownFunc:function(){!function(){var t=d.a.nodes(e,{match:function(e){return d.b.isElement(e)&&e.type===r.LINK}});Object(s.a)(t,1)[0]||d.h.wrapNodes(e,{type:r.LINK,url:"http://www.baidu.com",children:[]},{split:!0})}()},disabledCondition:function(e){return null==e.selection},children:Object(A.jsx)(Ie.a,{})})},ke=n(22),Ae=n.n(ke),Pe=n(84),Re=n(392),ze=n(118),Fe=n.n(ze),Be=["image/apng","image/avif","image/gif","image/jpeg","image/png","image/svg+xml","image/webp"],_e=5242880;var We=function(){var e=Object(Pe.a)(Ae.a.mark((function e(t){var n,r,a,i;return Ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(a=new FormData).append("file",t),e.next=5,Fe()({method:"post",url:"http://localhost:3001/uploadFile",data:a,headers:{"Content-Type":"multipart/form-data;charset=UTF-8"}});case 5:return i=e.sent,e.abrupt("return","http://localhost:3001/".concat(null===i||void 0===i||null===(n=i.data)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.filename));case 9:return e.prev=9,e.t0=e.catch(0),e.next=13,new Promise((function(e){setTimeout((function(){e()}),2e3)}));case 13:return e.abrupt("return",URL.createObjectURL(t));case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),He=function(e,t){var n=function(e){var t=[],n=[];return Array.isArray(e)&&Array.from(e).forEach((function(e){!Be.includes(e.type)||e.size>_e?n.push(e):t.push(e)})),{legalFiles:t,illegalFiles:n}}(t=Array.from(t)),a=n.illegalFiles,i=n.legalFiles;a.length>0&&B.b.error(a.map((function(e){return e.name})).join("\uff0c")+"\uff0c\u6587\u4ef6\u683c\u5f0f\u975e\u6cd5\uff08\u6216\u8d85\u8fc7\u6700\u5927\u9650\u5236".concat(5,"M\uff09"));var o,c=Object(v.a)(i);try{var l=function(){var t=o.value;!function(e,t,n,a){e.selection&&d.f.isExpanded(e.selection)&&d.h.collapse(e,{edge:"end"}),d.h.insertNodes(e,{type:r.IMG,url:t,id:n,children:[{text:""}]}),d.h.move(e),a(n)}(e,URL.createObjectURL(t),(new Date).getTime(),function(){var n=Object(Pe.a)(Ae.a.mark((function n(r){var a;return Ae.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,We(t);case 2:a=n.sent,d.h.setNodes(e,{id:null,url:a},{at:[],match:function(e){return d.b.isElement(e)&&e.id===r}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())};for(c.s();!(o=c.n()).done;)l()}catch(s){c.e(s)}finally{c.f()}},Ye=function(){var e=Object(u.g)(),t=Object(a.useRef)();return Object(A.jsxs)(Se,{title:"\u63d2\u5165\u56fe\u7247\uff08\u652f\u6301\u683c\u5f0f\uff1a".concat(Be.join("\uff0c").replace(/image\//gi,"."),"\uff09"),mousedownFunc:function(){t.current&&t.current.click()},disabledCondition:function(e){return null==e.selection},children:[Object(A.jsx)("input",{ref:t,type:"file",accept:"image/*",multiple:!0,hidden:!0,onChange:function(t){var n=t.target.files;n&&He(e,n)}}),Object(A.jsx)(Re.a,{})]})},Ue=n(393),Ve=[".doc",".docx",".xlsx",".xls",".csv",".pdf",".txt",".zip",".7z",".ppt",".pptx"],qe=10485760;var Ke=function(){var e=Object(Pe.a)(Ae.a.mark((function e(t){var n,r,a,i;return Ae.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,(a=new FormData).append("file",t),e.next=5,Fe()({method:"post",url:"http://localhost:3001/uploadFile",data:a,headers:{"Content-Type":"multipart/form-data;charset=UTF-8"}});case 5:return i=e.sent,e.abrupt("return","http://localhost:3001/".concat(null===i||void 0===i||null===(n=i.data)||void 0===n||null===(r=n[0])||void 0===r?void 0:r.filename));case 9:return e.prev=9,e.t0=e.catch(0),e.next=13,new Promise((function(e){setTimeout((function(){e()}),2e3)}));case 13:return e.abrupt("return",URL.createObjectURL(t));case 14:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}(),Ge=function(e,t){var n=function(e){var t=[],n=[];return Array.isArray(e)&&Array.from(e).forEach((function(e){var r,a=null===(r=e.name.match(/\.\w+$/g))||void 0===r?void 0:r[0];!a||!Ve.includes(a)||e.size>qe?n.push(e):t.push(e)})),{legalFiles:t,illegalFiles:n}}(t=Array.from(t)),a=n.illegalFiles,i=n.legalFiles;a.length>0&&B.b.error(a.map((function(e){return e.name})).join("\uff0c")+"\uff0c\u6587\u4ef6\u683c\u5f0f\u975e\u6cd5\uff08\u6216\u8d85\u8fc7\u6700\u5927\u9650\u5236".concat(10,"M\uff09"));var o,c=Object(v.a)(i);try{var l=function(){var t=o.value;!function(e,t,n,a,i){e.selection&&d.f.isExpanded(e.selection)&&d.h.collapse(e,{edge:"end"}),d.h.insertNodes(e,{type:r.FILE,url:t,fileName:n,id:a,children:[{text:""}]}),d.h.move(e),i(a)}(e,URL.createObjectURL(t),t.name,(new Date).getTime(),function(){var n=Object(Pe.a)(Ae.a.mark((function n(r){var a;return Ae.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Ke(t);case 2:a=n.sent,d.h.setNodes(e,{id:null,url:a},{at:[],match:function(e){return d.b.isElement(e)&&e.id===r}});case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())};for(c.s();!(o=c.n()).done;)l()}catch(s){c.e(s)}finally{c.f()}},Xe=function(){var e=Object(u.g)(),t=Object(a.useRef)();return Object(A.jsxs)(Se,{title:"\u63d2\u5165\u9644\u4ef6\uff08\u652f\u6301\u683c\u5f0f\uff1a".concat(Ve.join("\uff0c"),"\uff09"),mousedownFunc:function(){t.current&&t.current.click()},disabledCondition:function(e){return null==e.selection},children:[Object(A.jsx)("input",{ref:t,type:"file",multiple:!0,hidden:!0,onChange:function(t){var n=t.target.files;n&&Ge(e,n)}}),Object(A.jsx)(Ue.a,{})]})},Je=n(394),$e=function(e){var t=Object(u.f)(),n=Object(a.useState)(!1),i=Object(s.a)(n,2),o=i[0],c=i[1],l=Object(a.useState)(""),f=Object(s.a)(l,2),h=f[0],b=f[1],j=Object(a.useRef)(),v=Object(a.useState)(!1),O=Object(s.a)(v,2),p=O[0],g=O[1],y=Object(a.useRef)({_isDisabled:m.a.debounce((function(){g(null==t.selection)}),Z)});Object(a.useEffect)((function(){y.current._isDisabled()}));var T=function(e){var t=j.current,n=e.target,r=e.target.parentNode;if(t&&n&&r){Array.from(t.querySelectorAll("td")).forEach((function(e){e.style.backgroundColor="unset"}));for(var a=Array.from(t.querySelectorAll("tr")),i=0;i<=r.rowIndex;i++)for(var o=a[i],c=Array.from(o.querySelectorAll("td")),l=0;l<=n.cellIndex;l++){c[l].style.backgroundColor="rgba(180,215,255,.7)"}b("".concat(n.cellIndex+1,"x").concat(r.rowIndex+1))}},w=function(){var e=Number(h.split("x")[0]),n=Number(h.split("x")[1]);if(Number.isInteger(e)&&Number.isInteger(n)&&(u.b.focus(t),t.selection)){var a=d.a.nodes(t,{mode:"lowest",match:function(e){return x.isTextWrapper(e)}}),i=Object(s.a)(a,1)[0];if(i){var o=u.b.toDOMNode(t,i[0]);if(o.offsetParent){var l=o.offsetWidth-2;d.h.insertNodes(t,{type:r.TABLE,wrapperWidthWhenCreated:l,children:[{type:r.TBODY,children:new Array(n).fill("0").map((function(){return{type:r.TR,children:new Array(e).fill("0").map((function(){return{type:r.TD,width:l/e,height:R,children:[{type:r.DIV,children:[{text:""}]}]}}))}}))}]}),d.h.deselect(t),c(!1)}}}};return Object(a.useMemo)((function(){return Object(A.jsx)("div",{onMouseLeave:function(){c(!1)},children:Object(A.jsx)(ce.a,{placement:"bottomCenter",overlayStyle:{zIndex:999},visible:o,overlay:function(){return Object(A.jsxs)("div",{className:"cyEditor__toolbar__tablePanelWrapper",style:{width:200,padding:8,display:"flex",justifyContent:"flex-start",backgroundColor:"white",flexDirection:"column"},children:[o?Object(A.jsx)("table",{border:"1",ref:j,children:Object(A.jsx)("tbody",{children:new Array(10).fill(0).map((function(e,t){return Object(A.jsx)("tr",{children:new Array(10).fill(0).map((function(e,t){return Object(A.jsx)("td",{onMouseEnter:T,onClick:w},t)}))},t)}))})}):null,Object(A.jsx)("div",{style:{textAlign:"right"},children:h})]})},trigger:["click"],getPopupContainer:function(e){return e.parentElement||document.body},children:Object(A.jsx)(G.a,{title:"\u8868\u683c",zIndex:99,mouseLeaveDelay:0,mouseEnterDelay:0,children:Object(A.jsx)(X.a,{type:"text",onMouseDown:function(e){e.preventDefault(),c(!0)},disabled:p,children:Object(A.jsx)(Je.a,{})})})})})}),[o,p,h])},Qe=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u5220\u9664\u8868\u683c",mousedownFunc:function(){H.deleteTable(e)},disabledCondition:x.isSelectTd,children:Object(A.jsx)(le.a,{})})},Ze=n(395),et=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u5220\u9664\u5217",mousedownFunc:function(){H.deleteColumn(e)},disabledCondition:x.isSelectTd,children:Object(A.jsx)(Ze.a,{})})},tt=n(396),nt=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u5220\u9664\u884c",mousedownFunc:function(){H.deleteRow(e)},disabledCondition:x.isSelectTd,children:Object(A.jsx)(tt.a,{})})},rt=n(397),at=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u8868\u683c\u540e\u63d2\u5165\u6587\u672c",mousedownFunc:function(){H.insertDivAfterTable(e)},disabledCondition:x.isSelectTd,children:Object(A.jsx)(rt.a,{})})},it=n(398),ot=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u8868\u683c\u524d\u63d2\u5165\u6587\u672c",mousedownFunc:function(){H.insertDivBeforeTable(e)},disabledCondition:x.isSelectTd,children:Object(A.jsx)(it.a,{})})},ct=n(399),lt=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u5de6\u63d2\u5165\u5217",mousedownFunc:function(){H.insertColumn(e,"before")},disabledCondition:x.isSelectTd,children:Object(A.jsx)(ct.a,{})})},st=n(400),dt=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u53f3\u63d2\u5165\u5217",mousedownFunc:function(){H.insertColumn(e,"after")},disabledCondition:x.isSelectTd,children:Object(A.jsx)(st.a,{})})},ut=n(401),ft=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u4e0a\u63d2\u5165\u884c",mousedownFunc:function(){H.insertRow(e,"before")},disabledCondition:x.isSelectTd,children:Object(A.jsx)(ut.a,{})})},ht=n(402),bt=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u4e0b\u63d2\u5165\u884c",mousedownFunc:function(){H.insertRow(e,"after")},disabledCondition:x.isSelectTd,children:Object(A.jsx)(ht.a,{})})},jt=n(403),vt=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u5408\u5e76\u5355\u5143\u683c",mousedownFunc:function(){H.mergeTd(e)},disabledCondition:x.isSelectTd,children:Object(A.jsx)(jt.a,{})})},Ot=n(404),pt=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u62c6\u5206\u5355\u5143\u683c",mousedownFunc:function(){H.splitTd(e)},disabledCondition:x.isSelectTd,children:Object(A.jsx)(Ot.a,{})})},mt=n(405),gt=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u6e05\u7a7a\u5355\u5143\u683c",mousedownFunc:function(){F.clearTd(e)},disabledCondition:x.isSelectTd,children:Object(A.jsx)(mt.a,{})})},yt=n(406),xt=function(){var e=Object(u.g)();return Object(A.jsx)(Se,{title:"\u63d2\u5165\u4ee3\u7801\u5757",mousedownFunc:function(){d.h.insertNodes(e,{type:r.CODE,defaultMode:"javascript",children:[{text:""}]})},disabledCondition:function(e){return null==e.selection},children:Object(A.jsx)(yt.a,{})})},Tt=function(e){var t=Object(a.useContext)(Jt),n=t.readOnly,r=t.setReadOnly,i=n?"\u7f16\u8f91\u6a21\u5f0f":"\u53ea\u8bfb\u6a21\u5f0f";return Object(A.jsx)(J,{title:i,mousedownFunc:function(){r(!n)},children:i})},wt=function(e){var t=Object(u.g)(),n=Object(A.jsx)(Y.a,{style:{height:20,backgroundColor:"rgb(0 0 0 / 10%)"},type:"vertical"});return Object(A.jsx)("div",{className:"cyEditor__toolBar",style:{position:"relative",marginBottom:4},children:Object(A.jsxs)(U.a,{align:"middle",children:[Object(A.jsx)(V.a,{children:Object(A.jsx)(ie,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(ae,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(re,{})}),Object(A.jsx)(V.a,{children:n}),Object(A.jsx)(V.a,{children:Object(A.jsx)(ee,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)($,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(fe,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(be,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Oe,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(me,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(ye,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Te,{})}),Object(A.jsx)(V.a,{children:n}),Object(A.jsx)(V.a,{children:Object(A.jsx)(xt,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Ee,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(De,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Le,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Me,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Ye,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Xe,{})}),Object(A.jsx)(V.a,{children:n}),Object(A.jsx)(V.a,{children:Object(A.jsx)($e,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Qe,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(et,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(nt,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(at,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(ot,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(lt,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(dt,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(ft,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(bt,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(vt,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(pt,{})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(gt,{})}),Object(A.jsx)(V.a,{children:n}),Object(A.jsx)(V.a,{children:Object(A.jsx)(J,{title:"\u8f93\u51fa\u5185\u5bb9",mousedownFunc:function(){console.log(JSON.stringify(t.children)),window.localStorage.setItem("savedContent",JSON.stringify(t.children))},children:Object(A.jsx)(q.a,{})})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(Tt,{})})]})})},St=function e(t){var n,a;if(3===t.nodeType)return t.textContent;if(1!==t.nodeType)return null;var i={};null===(n=t.style)||void 0===n||null===(a=n.cssText)||void 0===a||a.split(";").forEach((function(e){var t=e.split(":"),n=Object(s.a)(t,2),r=n[0],a=n[1];if(!r)return null;var o=r.trim().replace(/^([a-z]+)-([a-z])([a-z]+)$/gi,(function(e,t,n,r){return t+n.toUpperCase()+r})),c=a.trim();"textDecoration"===o?(c.includes("underline")&&(i[h.Underline]=!0),c.includes("line-through")&&(i[h.LineThrough]=!0)):"bold"===c?i[h.BOLD]=!0:"italic"===c?i[h.ITALIC]=!0:Object.values(h).includes(o)&&(i[o]=c),"width"===o&&(i.width=parseInt(c)),"height"===o&&(i.height=parseInt(c))}));var o=Array.from(t.childNodes).map(e);switch(0===o.length&&(o=[{text:""}]),t.nodeName){case"BR":return"\n";case"BODY":return Object(g.a)("fragment",{},o);case"P":case"DIV":var c=(Array.from(null===t||void 0===t?void 0:t.childNodes)||[]).every((function(e){return 3===e.nodeType}));return Object(g.a)("element",Object(l.a)({type:c?r.DIV:r.Block},i),o);case"H1":return Object(g.a)("element",Object(l.a)({type:r.H1},i),o);case"H2":return Object(g.a)("element",Object(l.a)({type:r.H2},i),o);case"H3":return Object(g.a)("element",Object(l.a)({type:r.H3},i),o);case"H4":return Object(g.a)("element",Object(l.a)({type:r.H4},i),o);case"A":return Object(g.a)("element",Object(l.a)({type:r.LINK,url:t.getAttribute("href")},i),o);case"IMG":return Object(g.a)("element",Object(l.a)({type:r.IMG,url:t.getAttribute("src")},i),o);case"UL":return Object(g.a)("element",Object(l.a)({type:r.NORMAL_LIST},i),o);case"OL":return Object(g.a)("element",Object(l.a)({type:r.NUMBER_LIST},i),o);case"LI":return Object(g.a)("element",Object(l.a)({type:r.LIST_ITEM},i),o);case"TABLE":return Object(g.a)("element",Object(l.a)({type:r.TABLE},i),o);case"TBODY":return Object(g.a)("element",Object(l.a)({type:r.TBODY},i),o);case"TR":return Object(g.a)("element",Object(l.a)({type:r.TR},i),o);case"TD":return Object(g.a)("element",Object(l.a)(Object(l.a)({type:r.TD},i),{},{rowSpan:t.getAttribute("rowspan")||1,colSpan:t.getAttribute("colspan")||1}),o);default:return t.textContent}},Et=function(e){var t=(new DOMParser).parseFromString(e,"text/html");return St(t.body)},Nt=function(e,t){if(C(t).size>0)!function(e,t){var n=H.getSelectedTdsSize(t)>1,r=function(){return H.getFirstSelectedTd(t)};switch(e.key){case"Delete":case"Backspace":F.clearTd(t);break;case"Tab":if(e.preventDefault(),n)break;var a=r();a&&F.findTargetTd(t,a,e.shiftKey?"left":"right");break;case"Escape":e.preventDefault(),F.deselectAllTd(t);break;case" ":case"Enter":if(e.preventDefault(),n)break;var i=r();i&&F.editTd(t,i);break;case"ArrowUp":if(e.preventDefault(),n)break;var o=r();o&&F.findTargetTd(t,o,"up");break;case"ArrowDown":if(e.preventDefault(),n)break;var c=r();c&&F.findTargetTd(t,c,"down");break;case"ArrowLeft":if(e.preventDefault(),n)break;var l=r();l&&F.findTargetTd(t,l,"left");break;case"ArrowRight":if(e.preventDefault(),n)break;var s=r();s&&F.findTargetTd(t,s,"right")}if(!e.ctrlKey&&(1===e.key.length||"Process"===e.key)){if(n)return;var d=r();return F.clearTd(t),void(d&&F.editTd(t,d))}if(e.ctrlKey&&"c"===e.key)return w(null),void H.copyCells(t);e.ctrlKey&&"v"===e.key&&H.pasteCells(t)}(e,t);else{var n=t.selection;if(n)return d.f.isExpanded(n)?function(e,t){var n=t.selection;if(n)switch(e.key){case"Escape":var r=d.a.nodes(t,{at:n,match:function(e){return H.isTd(e)&&!0===e.canTdEdit}}),a=Object(s.a)(r,2),i=a[0],o=a[1];if(!i||o)break;F.chooseTd(t,i);break;case"Tab":e.preventDefault();var c,l=Object(v.a)(d.a.nodes(t,{at:n,reverse:!0,universal:!0,match:function(e){return x.isTextWrapper(e)}}));try{for(l.s();!(c=l.n()).done;){var u=Object(s.a)(c.value,2)[1],f=x.getParent(t,u),h=Object(s.a)(f,2),b=h[0],j=h[1];b&&y.isListItem(b)&&(e.shiftKey?y.liftLi(t,[b,j]):y.indentLi(t,[b,j]))}}catch(O){l.e(O)}finally{l.f()}}}(e,t):d.f.isCollapsed(n)?function(e,t){var n=t.selection;if(n){var a=x.getFirstAboveElementType(t),i=function(){var e;return null===(e=H.getEditingTds(t))||void 0===e?void 0:e[0]};switch(e.key){case"Tab":if(e.preventDefault(),r.LIST_ITEM===a){e.shiftKey?y.shiftTabEvent(t):y.tabEvent(t);break}if(r.TD===a){e.shiftKey?H.shiftTabEvent(t):H.tabEvent(t);break}!e.shiftKey&&d.h.insertText(t,"    ");break;case"Escape":var o=i();if(!o)break;F.chooseTd(t,o);break;case"ArrowUp":var c=i();return c&&d.c.child(c[0],0)==d.a.parent(t,n.anchor)[0]?(F.findTargetTd(t,c,"up"),d.h.deselect(t),void e.preventDefault()):void 0;case"ArrowDown":var l=i();return l&&d.c.child(l[0],l[0].children.length-1)==d.a.parent(t,n.anchor)[0]?(F.findTargetTd(t,l,"down"),d.h.deselect(t),void e.preventDefault()):void 0;case"ArrowLeft":var s=i();return s&&d.a.isStart(t,n.anchor,s[1])?(F.findTargetTd(t,s,"left"),d.h.deselect(t),void e.preventDefault()):void 0;case"ArrowRight":var u=i();return u&&d.a.isEnd(t,n.anchor,u[1])?(F.findTargetTd(t,u,"right"),d.h.deselect(t),void e.preventDefault()):void 0}}}(e,t):void 0}},Dt=n(408),Ct=n(409),Lt=n(410),It=n(379),Mt=n(122),kt=(n(347),n(151)),At=n.n(kt),Pt=function(e){var t=e.attributes,n=e.children,r=e.element,i=Object(u.d)(),o=Object(u.e)(),c=Object(u.g)(),f=Object(a.useState)({size:{width:r.width||100,height:r.height||100},showTool:!1}),h=Object(s.a)(f,2),b=h[0],j=h[1],v=Object(a.useRef)(),O=Object(a.useCallback)((function(e){e&&!v.current&&i&&(v.current=new At.a(e,{}))}),[i]),p=Object(A.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,opacity:.8,color:"white",display:"flex",justifyContent:"center",alignItems:"center",fontSize:12,backgroundColor:"black",zIndex:9},children:"uploading..."}),m=[{title:"\u8fb9\u6846",icon:Object(A.jsx)(Dt.a,{}),method:function(){var e=u.b.findPath(c,r);d.h.setNodes(c,{border:!0},{at:e})}},{title:"\u53d6\u6d88\u8fb9\u6846",icon:Object(A.jsx)(Ct.a,{}),method:function(){var e=u.b.findPath(c,r);d.h.unsetNodes(c,"border",{at:e})}},{title:"\u67e5\u770b\u5927\u56fe",icon:Object(A.jsx)(Lt.a,{}),method:function(){var e=u.b.toDOMNode(c,r).querySelector("img");if(e){var t=new At.a(e,{hidden:function(){t.destroy()}});t.show()}}},{title:"\u5220\u9664",icon:Object(A.jsx)(le.a,{}),method:function(){var e=u.b.findPath(c,r);d.h.delete(c,{at:e,voids:!0,reverse:!0}),u.b.focus(c)}}];return Object(A.jsx)("div",Object(l.a)(Object(l.a)({},t),{},{contentEditable:!1,style:{position:"relative",display:"inline-block",margin:5,verticalAlign:"bottom",boxShadow:o?"0 0 0 3px rgba(180,215,255,.7)":"none",border:r.border?"1px solid #e5e5e5":"none"},children:Object(A.jsxs)(Mt.a,{enable:u.b.isReadOnly(c)?{top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1}:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{display:"inline-block"},size:b.size,onResizeStop:function(e,t,n,a){var i=b.size.width+a.width,o=b.size.height+a.height;j((function(e){return Object(l.a)(Object(l.a)({},e),{},{size:{width:i,height:o}})}));var s=u.b.findPath(c,r);d.h.setNodes(c,{children:[],width:i,height:o},{at:s})},children:[r.id?p:null,Object(A.jsx)(It.a,{content:Object(A.jsx)(U.a,{gutter:8,children:m.map((function(e){return Object(A.jsx)(V.a,{children:Object(A.jsx)(G.a,{title:e.title,children:Object(A.jsx)(X.a,{onClick:e.method,type:"text",icon:e.icon})})},e.title)}))}),trigger:i?[]:"click",placement:"bottomLeft",children:Object(A.jsx)("img",{ref:O,width:"100%",height:"100%",alt:"",src:r.url})}),n]})}))},Rt=n(411),zt=function(e){var t=e.attributes,n=e.children,r=e.element,a=Object(u.d)(),i=Object(u.g)(),o=Object(A.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",top:0,left:0,opacity:.5,color:"white",display:"flex",justifyContent:"center",alignItems:"center",fontSize:12,backgroundColor:"black",zIndex:9},children:"uploading..."}),c=[{title:"\u4e0b\u8f7d",icon:Object(A.jsx)(Rt.a,{}),method:function(){window.open(r.url)}},{title:"\u5220\u9664",icon:Object(A.jsx)(le.a,{}),method:function(){var e=u.b.findPath(i,r);d.h.delete(i,{at:e,voids:!0,reverse:!0}),u.b.focus(i)}}];return Object(A.jsxs)("div",Object(l.a)(Object(l.a)({},t),{},{contentEditable:!1,style:{position:"relative",display:"inline-block",margin:"0 5px",verticalAlign:"bottom"},children:[r.id?o:null,Object(A.jsx)(It.a,{content:Object(A.jsx)(U.a,{gutter:8,children:c.map((function(e){return Object(A.jsx)(V.a,{children:Object(A.jsx)(G.a,{title:e.title,children:Object(A.jsx)(X.a,{onClick:e.method,type:"text",icon:e.icon})})},e.title)}))}),trigger:a?[]:"click",placement:"bottomLeft",children:Object(A.jsxs)("a",{download:!0,href:r.url,rel:"noopener noreferrer",target:"_blank",children:[Object(A.jsx)(Ue.a,{style:{marginRight:2}}),r.fileName]})}),n]}))},Ft=n(412),Bt=n(413),_t=n(374),Wt=n(376),Ht=function(e){var t=e.attributes,n=e.children,i=e.element,o=Object(u.g)(),c=Object(u.d)(),f=Object(a.useState)(),h=Object(s.a)(f,2),b=h[0],j=h[1],v=Object(a.useState)(),O=Object(s.a)(v,2),p=O[0],m=O[1],g={marginBottom:6},y=Object(A.jsx)(_t.a,{size:"small",children:Object(A.jsxs)(U.a,{gutter:8,style:{flexDirection:"column",width:300},children:[Object(A.jsx)(V.a,{flex:"1",children:Object(A.jsxs)(_t.a.Item,{label:"\u64cd\u4f5c",style:g,children:[Object(A.jsxs)(X.a,{size:"small",onClick:function(){window.open(i.url)},children:[Object(A.jsx)(Ft.a,{title:"\u8bbf\u95ee\u94fe\u63a5"})," \u8bbf\u95ee\u94fe\u63a5"]}),"\xa0",Object(A.jsxs)(X.a,{size:"small",onMouseDown:function(e){e.preventDefault(),u.b.focus(o),o.selection&&d.h.unwrapNodes(o,{match:function(e){return d.b.isElement(e)&&e.type==r.LINK}})},children:[Object(A.jsx)(Bt.a,{title:"\u53d6\u6d88\u94fe\u63a5"})," \u53d6\u6d88\u94fe\u63a5"]})]})}),Object(A.jsx)(V.a,{flex:"1",children:Object(A.jsx)(_t.a.Item,{label:"\u6587\u5b57",style:g,children:Object(A.jsx)(Wt.a,{value:b,onChange:function(e){j(e.target.value)}})})}),Object(A.jsx)(V.a,{children:Object(A.jsx)(_t.a.Item,{label:"\u94fe\u63a5",style:g,children:Object(A.jsx)(Wt.a,{value:p,onChange:function(e){m(e.target.value)}})})}),Object(A.jsx)(U.a,{justify:"end",children:Object(A.jsx)(X.a,{type:"primary",style:{width:100,marginRight:4},onClick:function(){u.b.focus(o);var e=u.b.toSlateNode(o,t.ref.current),n=u.b.findPath(o,e);e&&n&&(d.h.insertText(o,b||"link",{at:d.a.range(o,n)}),d.h.setNodes(o,{url:p},{at:n}))},children:"\u786e\u5b9a"})})]})});return Object(A.jsx)("div",Object(l.a)(Object(l.a)({},t),{},{style:{display:"inline",position:"relative"},children:Object(A.jsx)(It.a,{placement:"right",content:y,trigger:c?[]:["hover"],children:Object(A.jsx)("a",{href:i.url,target:"__blank",onMouseEnter:function(){return function(){var e=t.ref.current.querySelector("a");e&&(m(e.href),j(e.innerText))}()},children:n})})}))},Yt=n(200);n(348),n(349),n(350),n(351),n(352),n(105),n(89),n(353),n(354),n(364);var Ut=[{title:"html",value:"text/html"},{title:"javascript",value:"javascript"},{title:"react",value:"text/jsx"},{title:"react-ts",value:"text/typescript-jsx"},{title:"vue",value:"vue"},{title:"java",value:"text/x-java"},{title:"c++",value:"text/x-c++src"}],Vt=function(e){var t=e.attributes,n=e.children,r=e.element,i=Object(u.d)(),o=Object(u.g)(),c=Object(a.useState)({size:{width:"100%",height:r.height||300},showTool:!1}),f=Object(s.a)(c,2),h=f[0],b=f[1],j=Object(a.useState)(r.defaultCode||""),v=Object(s.a)(j,2),O=v[0],p=v[1],g=Object(a.useRef)(null),y=Object(a.useRef)(m.a.debounce((function(e){var t=u.b.findPath(o,r);d.h.setNodes(o,{children:[],defaultCode:e},{at:t})}),100)),x=Object(a.useMemo)((function(){return{mode:r.defaultMode,theme:"darcula",lineNumbers:!0,readOnly:!!i&&"nocursor"}}),[r.defaultMode,i]),T=Object(a.useCallback)((function(e){g.current=e,e.setSize("100%",r.height)}),[]),w=Object(a.useCallback)((function(e,t,n){y.current(n)}),[y]);return Object(A.jsxs)("div",Object(l.a)(Object(l.a)({},t),{},{contentEditable:!1,children:[Object(A.jsxs)(Mt.a,{enable:u.b.isReadOnly(o)?{top:!1,right:!1,bottom:!1,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1}:{top:!1,right:!1,bottom:!0,left:!1,topRight:!1,bottomRight:!1,bottomLeft:!1,topLeft:!1},style:{display:"inline-block",position:"relative"},size:h.size,onResizeStop:function(e,t,n,a){b((function(e){return Object(l.a)(Object(l.a)({},e),{},{size:Object(l.a)(Object(l.a)({},e.size),{},{height:n.offsetHeight})})}));var i=u.b.findPath(o,r);d.h.setNodes(o,{children:[],height:n.offsetHeight},{at:i})},onResize:function(e,t,n,r){var a;null===(a=g.current)||void 0===a||a.setSize("100%",n.offsetHeight)},children:[Object(A.jsx)("div",{style:{color:"white",position:"absolute",right:30,top:5,zIndex:7},children:Object(A.jsx)(te.a,{size:"small",defaultValue:r.defaultMode,style:{width:120,color:"white",textAlign:"right"},bordered:!1,showArrow:!1,onChange:function(e){var t=u.b.findPath(o,r);d.h.setNodes(o,{children:[],defaultMode:e},{at:t})},children:Ut.map((function(e){return Object(A.jsx)(te.a.Option,{value:e.value,children:e.title},e.value)}))})}),Object(a.useMemo)((function(){return Object(A.jsx)(Yt.Controlled,{value:O,onBeforeChange:function(e,t,n){p(n)},options:x,onChange:w,editorDidMount:T})}),[O,x,T,w])]}),n]}))},qt=n(378),Kt=function(e){var t=e.attributes,n=e.children,r=e.element,a=Object(u.g)(),i=Object(u.d)();return Object(A.jsxs)("div",Object(l.a)(Object(l.a)({},t),{},{children:[Object(A.jsx)("span",{contentEditable:!1,style:{marginRight:12},children:Object(A.jsx)(qt.a,{checked:r.checked,onChange:function(e){d.h.setNodes(a,{checked:e.target.checked},{at:u.b.findPath(a,r)})},disabled:i})}),Object(A.jsx)("span",{children:n})]}))},Gt=function(e){var t=e.attributes,n=e.children,a=e.element,i={};switch(b.includes(a.type)&&a.textAlign&&(i.textAlign=a.textAlign),a.type){case r.TODOLIST:return Object(A.jsx)(Kt,Object(l.a)({},e));case r.NUMBER_LIST:return Object(A.jsx)("ol",Object(l.a)(Object(l.a)({},t),{},{children:n}));case r.NORMAL_LIST:return Object(A.jsx)("ul",Object(l.a)(Object(l.a)({},t),{},{children:n}));case r.LIST_ITEM:return Object(A.jsx)("li",Object(l.a)(Object(l.a)({},t),{},{style:{color:a.liColor||"unset"},children:n}));case r.DIV:return Object(A.jsx)("div",Object(l.a)(Object(l.a)({},t),{},{style:i,children:n}));case r.H1:return Object(A.jsx)("h1",Object(l.a)(Object(l.a)({},t),{},{style:Object(l.a)({},i),children:n}));case r.H2:return Object(A.jsx)("h2",Object(l.a)(Object(l.a)({},t),{},{style:Object(l.a)({},i),children:n}));case r.H3:return Object(A.jsx)("h3",Object(l.a)(Object(l.a)({},t),{},{style:Object(l.a)({},i),children:n}));case r.H4:return Object(A.jsx)("h4",Object(l.a)(Object(l.a)({},t),{},{style:Object(l.a)({},i),children:n}));case r.IMG:return Object(A.jsx)(Pt,Object(l.a)(Object(l.a)({},e),{},{children:n}));case r.LINK:return Object(A.jsx)(Ht,Object(l.a)({},e));case r.TABLE:return Object(A.jsx)(_,Object(l.a)({},e));case r.TBODY:return Object(A.jsx)("tbody",Object(l.a)(Object(l.a)({},t),{},{children:n}));case r.TR:var o={};return a.shouldEmpty&&(o.contentEditable=!1),Object(A.jsx)("tr",Object(l.a)(Object(l.a)(Object(l.a)({},t),o),{},{children:a.shouldEmpty?null:n}));case r.TD:return Object(A.jsx)(z,Object(l.a)({},e));case r.CODE:return Object(A.jsx)(Vt,Object(l.a)({},e));case r.FILE:return Object(A.jsx)(zt,Object(l.a)({},e));default:return Object(A.jsx)("div",Object(l.a)(Object(l.a)({},t),{},{children:n}))}},Xt=function(e){var t=e.attributes,n=e.children,r=e.leaf,a={};return r[h.BOLD]&&(a.fontWeight="bold"),r[h.ITALIC]&&(a.fontStyle="italic"),r[h.FontSize]&&(a.fontSize=r.fontSize),(r[h.Underline]||r[h.LineThrough])&&(a.textDecoration="".concat(r[h.Underline]?"underline":""," ").concat(r[h.LineThrough]?"line-through":"")),r[h.Color]&&(a.color=r[h.Color]),r[h.BGColor]&&(a.backgroundColor=r[h.BGColor]),Object(A.jsx)("span",Object(l.a)(Object(l.a)({},t),{},{style:a,children:n}))},Jt=(n(365),n(366),Object(a.createContext)({savedMarks:null,setSavedMarks:function(){},readOnly:!1,setReadOnly:function(){}})),$t=function(){var e=Object(a.useState)(function(e){var t=e.deleteForward,n=e.deleteBackward,a=e.deleteFragment,i=e.getFragment,o=e.insertText,c=e.insertData,l=e.insertBreak,u=e.isInline,h=e.isVoid,b=e.normalizeNode,v=e.apply,O=function(){var t=d.a.nodes(e,{match:function(e){return d.b.isElement(e)&&e.type===r.TODOLIST}});return Object(s.a)(t,1)[0]};e.apply=function(t){try{if("set_node"===t.type){var n=d.a.node(e,t.path),a=n&&d.b.isElement(n[0])&&n[0].type===r.IMG,i=n&&d.b.isElement(n[0])&&n[0].type===r.FILE,o=n&&H.isTd(n[0]),c=n&&H.isTable(n[0]),l=t.newProperties,s=t.properties;if(o&&(l.selected||l.width||l.start||l.canTdEdit||s.start||s.selected||s.width||s.canTdEdit)||c&&(l.wrapperWidthWhenCreated||s.wrapperWidthWhenCreated)||a||i)return void f.a.withoutSaving(e,(function(){v(t)}))}v(t)}catch(u){console.warn(u)}},e.insertBreak=function(){if(e.selection){var t=O();if(t)return t&&""===d.a.string(e,t[1],{voids:!0})?void d.h.setNodes(e,{type:r.DIV},{at:t[1]}):void l();if(d.f.isExpanded(e.selection))x.removeRangeElement(e);else{var n=x.getParent(e,e.selection.anchor.path);if(!n[0])return;var a=d.a.parent(e,n[1]),i=y.isListItem(a[0])&&a;if(i&&""===d.a.string(e,i[1],{voids:!0}))return void d.h.liftNodes(e,{at:i[1]})}l()}},e.deleteFragment=function(t){x.removeRangeElement(e),a(t)},e.deleteForward=function(n){if(e.selection){p();var r=d.a.above(e,{mode:"lowest",match:function(e){return y.isListItem(e)}}),a=d.a.above(e,{mode:"lowest",match:function(e){return H.isTd(e)}}),i=d.a.above(e,{mode:"lowest",match:function(e){return x.isTextWrapper(e)}}),o=r&&(!a||r[1].length>a[1].length);if(i&&""===d.a.string(e,i[1],{voids:!0}))d.h.removeNodes(e,{at:i[1]});else if(o&&r&&""===d.a.string(e,r[1],{voids:!0}))d.h.removeNodes(e,{at:r[1]});else{var c=d.a.after(e,e.selection.anchor),l=c&&d.a.above(e,{at:c,mode:"lowest",match:function(e){return H.isTd(e)}});a&&l&&!d.e.equals(a[1],l[1])||t(n)}}},e.deleteBackward=function(t){if(e.selection){var a=d.a.above(e,{at:d.a.before(e,e.selection),match:function(e){return d.b.isElement(e)&&e.type===r.CODE}});if(a)d.h.removeNodes(e,{at:a[1]});else{p();var i=O();if(i)return d.a.isStart(e,e.selection.anchor,i[1])?void d.h.removeNodes(e,{at:i[1]}):void n(t);var o=d.a.above(e,{mode:"lowest",match:function(e){return y.isListItem(e)}}),c=d.a.above(e,{mode:"lowest",match:function(e){return H.isTd(e)}}),l=d.a.above(e,{mode:"lowest",match:function(e){return x.isTextWrapper(e)}}),s=o&&(!c||o[1].length>c[1].length);if(l&&""===d.a.string(e,l[1],{voids:!0}))d.h.removeNodes(e,{at:l[1]});else{var u=d.a.before(e,e.selection.anchor);if(s&&o&&""===d.a.string(e,o[1],{voids:!0}))d.h.removeNodes(e,{at:o[1]});else{var f=d.a.above(e,{at:u,mode:"lowest",match:function(e){return H.isTd(e)}});f&&c&&!d.e.equals(f[1],c[1])||n(t)}}}}},e.insertText=function(t){O()||e.selection&&d.f.isExpanded(e.selection)&&x.removeRangeElement(e),o(t)},e.getFragment=function(){return S(null),N({copyedAreaHeight:0,copyedAreaWidth:0}),w(i()),i()},e.insertFragment=function(t){x.removeRangeElement(e),d.h.insertNodes(e,t)},e.insertData=function(t){var n=E();if(n){var r=d.a.nodes(e,{at:n[0][1],mode:"lowest",match:function(e){return H.isTable(e)}}),a=Object(s.a)(r,1)[0];if(a){var i=new DataTransfer;return i.setData("application/x-slate-fragment",x.encodeSlateContent([a[0]])),void c(i)}}else if(t.types.includes("application/x-slate-fragment"))c(t);else if(t.types.includes("text/plain")){var o=new DataTransfer,l=Et(t.getData("text/plain"));o.setData("application/x-slate-fragment",x.encodeSlateContent(l)),c(o)}else if(t.types.includes("Files")){var u=t.files;He(e,u),Ge(e,u)}};var p=m.a.debounce((function(){var t=d.a.next(e,{match:function(e){return y.isOrderList(e)}});t&&e.normalizeNode(t);var n=d.a.previous(e,{match:function(e){return y.isOrderList(e)}});n&&e.normalizeNode(n)}),0);return e.isInline=function(e){return!![r.IMG,r.FILE,r.LINK].includes(e.type)||u(e)},e.isVoid=function(e){return!![r.IMG,r.FILE,r.CODE].includes(e.type)||h(e)},e.normalizeNode=function(t){var n=Object(s.a)(t,2),a=n[0],i=n[1];if(d.b.isElement(a)&&a.type===r.CODE&&null==d.a.next(e,{at:i}))d.h.insertNodes(e,{type:r.DIV,children:[{text:""}]},{at:d.e.next(i)});else if(0!==e.children.length){if(d.b.isElement(a)&&d.a.isBlock(e,a)){var o=x.getParent(e,i),c=Object(s.a)(o,1)[0];if(x.isTextWrapper(c))return void d.h.removeNodes(e,{at:i})}if(d.b.isElement(a)&&j.includes(a.type)){var l=x.getPath(i,"pre"),u=x.getNodeByPath(e,l),f=Object(s.a)(u,1)[0];if(!d.g.isText(f))return void d.h.insertNodes(e,{text:""},{at:l});var h=x.getPath(i,"next"),v=x.getNodeByPath(e,h),O=Object(s.a)(v,1)[0];if(!d.g.isText(O))return void d.h.insertNodes(e,{text:""},{at:h})}d.b.isElement(a)&&a.type===r.LINK&&""===d.a.string(e,i,{voids:!0})?d.h.removeNodes(e,{at:i}):H.normalizeTable(e,t)||y.normalizeList(e,t)||b(t)}else d.h.insertNodes(e,{type:r.DIV,children:[{text:""}]})},e}(Object(f.b)(Object(u.h)(Object(d.i)())))),t=Object(s.a)(e,1)[0],n=Object(a.useState)((function(){var e=window.localStorage.getItem("savedContent")||JSON.stringify([{type:r.DIV,children:[{text:""}]}]);return JSON.parse(e)})),i=Object(s.a)(n,2),o=i[0],b=i[1],v=Object(a.useRef)({preUndos:[],preSelection:null}),O=Object(a.useState)(),p=Object(s.a)(O,2),g=p[0],T=p[1];Object(a.useEffect)((function(){document.body.style.cursor=null!=g?"copy":"auto"}),[g]);var D=Object(a.useState)(!1),C=Object(s.a)(D,2),L=C[0],I=C[1];Object(a.useEffect)((function(){}),[]);var M=Object(a.useCallback)((function(e){return Object(A.jsx)(Gt,Object(l.a)(Object(l.a)({},e),{},{editorRef:v}))}),[]),k=Object(a.useCallback)((function(e){return Object(A.jsx)(Xt,Object(l.a)({},e))}),[]),P=Object(a.useMemo)((function(){return Object(A.jsx)(wt,{})}),[]);return Object(A.jsx)("div",{className:"cyEditor",style:{position:"relative"},children:Object(A.jsx)(u.c,{editor:t,value:o,onChange:function(e){b(e)},children:Object(A.jsxs)(Jt.Provider,{value:Object(a.useMemo)((function(){return{savedMarks:g,setSavedMarks:T,readOnly:L,setReadOnly:I}}),[L,g]),children:[P,Object(A.jsx)("div",{className:"cyEditor__content",style:{overflow:"auto",height:window.screen.availHeight-200,border:"1px solid",padding:12},children:Object(A.jsx)(u.a,{renderElement:M,renderLeaf:k,autoFocus:!0,readOnly:L,onCompositionStart:function(){x.removeRangeElement(t)},placeholder:"welcome to cyEditor!",onKeyDown:function(e){return Nt(e,t)},onMouseDown:function(e){F.deselectAllTd(t)},onDragStart:function(e){e.preventDefault()},onBlur:function(){v.current.preSelection=t.selection},onFocus:function(){v.current.preSelection&&d.a.hasPath(t,v.current.preSelection.anchor.path)&&d.a.hasPath(t,v.current.preSelection.focus.path)&&d.h.select(t,v.current.preSelection)},onSelect:function(){if(null!=g){var e;if(H.getFirstSelectedTd(t))return;var n=g[h.TextAlign],r=d.a.above(t,{at:null===(e=t.selection)||void 0===e?void 0:e.anchor,mode:"lowest",match:function(e){return x.isTextWrapper(e)}});if(!r)return;for(var a=0,i=Object.values(h);a<i.length;a++){var o=i[a];d.a.removeMark(t,o)}for(var l in n&&d.h.unsetNodes(t,h.TextAlign,{at:r[1]}),g)"children"!==l&&d.a.addMark(t,l,g[l]);n&&d.h.setNodes(t,Object(c.a)({},h.TextAlign,g[h.TextAlign]),{at:r[1]}),T(null),document.body.style.cursor="auto",t.selection&&d.h.select(t,d.a.start(t,t.selection))}}})})]})})})};o.a.render(Object(A.jsx)($t,{}),document.getElementById("root"))}},[[367,1,2]]]);
//# sourceMappingURL=main.077525ca.chunk.js.map